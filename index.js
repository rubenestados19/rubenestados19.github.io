!function(n){"function"==typeof define&&define.amd?define(n):n()}((function(){"use strict";var n,t,e=function(){return e=Object.assign||function(n){for(var t,e=1,o=arguments.length;e<o;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},e.apply(this,arguments)};function o(n,t,e,o){return new(e||(e=Promise))((function(i,r){function d(n){try{u(o.next(n))}catch(n){r(n)}}function l(n){try{u(o.throw(n))}catch(n){r(n)}}function u(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(d,l)}u((o=o.apply(n,t||[])).next())}))}function i(n,t){var e,o,i,r,d={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(u){return function(l){if(e)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(d=0)),d;)try{if(e=1,o&&(i=2&l[0]?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return d.label++,{value:l[1],done:!1};case 5:d.label++,o=l[1],l=[0];continue;case 7:l=d.ops.pop(),d.trys.pop();continue;default:if(!(i=d.trys,(i=i.length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){d=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){d.label=l[1];break}if(6===l[0]&&d.label<i[1]){d.label=i[1],i=l;break}if(i&&d.label<i[2]){d.label=i[2],d.ops.push(l);break}i[2]&&d.ops.pop(),d.trys.pop();continue}l=t.call(n,d)}catch(n){l=[6,n],o=0}finally{e=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,u])}}}"function"==typeof SuppressedError&&SuppressedError,function(n){n[n.SF=1]="SF",n[n.EC1=2]="EC1",n[n.EC2=4]="EC2",n[n.OT=8]="OT"}(n||(n={})),function(n){n.EMAIL="email",n.PHONE="phone"}(t||(t={}));var r=function(){var n;return null!==(n={APP_ENV:"product",CDN_HOST:"https://cdn.kmalgo.com",APP_ID:"61162030bc1390001da5cede",VITE_BASE_DOMAIN:"https://client.smartpushedm.com",VITE_BASE_DOMAIN_NO:"client.smartpushedm.com"})&&void 0!==n?n:{}};function d(n){for(var t=document.cookie.split("; "),e=0;e<t.length;e++){var o=t[e].split("=");if(n==o[0])return o[1]}}var l,u=function(){return o(void 0,void 0,void 0,(function(){var n,t,e,o,d,l,u,a,c,s,v,p,w,f,h,m,g,y;return i(this,(function(i){switch(i.label){case 0:return n=r().APP_ID,t=null===(c=null===(a=null===window||void 0===window?void 0:window.shopline)||void 0===a?void 0:a.appExtension)||void 0===c?void 0:c.init({appId:n||""}),e="",[4,null===(s=null==t?void 0:t.utils)||void 0===s?void 0:s.getMerchantId()];case 1:return o=null!==(v=i.sent())&&void 0!==v?v:"",[4,null===(p=null==t?void 0:t.utils)||void 0===p?void 0:p.getCurrentPageIdentifier()];case 2:return d=null!==(w=i.sent())&&void 0!==w?w:"",[4,null===(f=null==t?void 0:t.utils)||void 0===f?void 0:f.getLoadedLanguage()];case 3:return l=null!==(h=i.sent())&&void 0!==h?h:{},[4,null===(g=null===(m=null==t?void 0:t.utils)||void 0===m?void 0:m.getPDPProduct)||void 0===g?void 0:g.call(m)];case 4:return u=null!==(y=i.sent())&&void 0!==y?y:"",[2,{uid:e,merchant_id:o,uri:d,lang:l,product:u,uuid:""}]}}))}))},a=function(){return o(void 0,void 0,void 0,(function(){var t,e,o,r,l,a,c,s,v;return i(this,(function(i){switch(i.label){case 0:switch(t="EC1"===(null===window||void 0===window?void 0:window.SmartPush)?n.EC1:(null===window||void 0===window?void 0:window.Shopline)?n.EC2:(null===window||void 0===window?void 0:window.ShopifyAnalytics)?n.SF:n.EC2,e=null!==(v=null===(s=null===window||void 0===window?void 0:window.location)||void 0===s?void 0:s.href)&&void 0!==v?v:"",o=e.split("?")[0],r={uuid:"",uid:"",merchant_id:"",url:o,uri:"",platform:t},t){case n.EC1:return[3,1];case n.EC2:return[3,3];case n.SF:return[3,4]}return[3,5];case 1:return[4,u()];case 2:return l=i.sent(),r.uuid=l.uuid,r.uid=l.uid,r.merchant_id=l.merchant_id,r.uri=l.uri,[3,5];case 3:return a=function(){var n,t,e,o,i,r,l,u,a,c,s,v,p=null!==(o=null!==(e=null===(t=null===(n=null===window||void 0===window?void 0:window.Shopline)||void 0===n?void 0:n.customer)||void 0===t?void 0:t.id)&&void 0!==e?e:d("osudb_uid"))&&void 0!==o?o:"",w=null!==(r=null===(i=null===window||void 0===window?void 0:window.Shopline)||void 0===i?void 0:i.storeId)&&void 0!==r?r:"",f=null!==(a=null===(u=null===(l=null===window||void 0===window?void 0:window.Shopline)||void 0===l?void 0:l.uri)||void 0===u?void 0:u.alias)&&void 0!==a?a:"";return{uid:p,merchant_id:w,lang:null!==(s=null===(c=null===window||void 0===window?void 0:window.Shopline)||void 0===c?void 0:c.storeLanguage)&&void 0!==s?s:"en",uri:f,uuid:null!==(v=d("n_u"))&&void 0!==v?v:""}}(),r.uuid=a.uuid,r.uid=a.uid,r.merchant_id=a.merchant_id,r.uri=a.uri,[3,5];case 4:return c=function(){var n,t,e,o,i,r,d,l,u,a,c,s,v,p,w,f,h,m,g,y,C,_,S,A,E,b,k,O,I,L,P,N,T,x,j,D,R;return{uid:null!==(d=null!==(o=null===(e=null===(t=null===(n=null===window||void 0===window?void 0:window.ShopifyAnalytics)||void 0===n?void 0:n.meta)||void 0===t?void 0:t.page)||void 0===e?void 0:e.customerId)&&void 0!==o?o:null===(r=null===(i=null===window||void 0===window?void 0:window.meta)||void 0===i?void 0:i.page)||void 0===r?void 0:r.customerId)&&void 0!==d?d:"",merchant_id:null!==(m=null!==(s=null===(c=null===(a=null===(u=null===(l=null===window||void 0===window?void 0:window.ShopifyAnalytics)||void 0===l?void 0:l.lib)||void 0===u?void 0:u.trekkie)||void 0===a?void 0:a.defaultAttributes)||void 0===c?void 0:c.shopId)&&void 0!==s?s:null===(h=null===(f=null===(w=null===(p=null===(v=null===window||void 0===window?void 0:window.ShopifyAnalytics)||void 0===v?void 0:v.lib)||void 0===p?void 0:p.config)||void 0===w?void 0:w.Trekkie)||void 0===f?void 0:f.defaultAttributes)||void 0===h?void 0:h.shopId)&&void 0!==m?m:"",uri:null!==(E=null!==(_=null===(C=null===(y=null===(g=null===window||void 0===window?void 0:window.ShopifyAnalytics)||void 0===g?void 0:g.meta)||void 0===y?void 0:y.page)||void 0===C?void 0:C.pageType)&&void 0!==_?_:null===(A=null===(S=null===window||void 0===window?void 0:window.meta)||void 0===S?void 0:S.page)||void 0===A?void 0:A.pageType)&&void 0!==E?E:"",lang:null!==(D=null!==(L=null===(I=null===(O=null===(k=null===(b=null===window||void 0===window?void 0:window.ShopifyAnalytics)||void 0===b?void 0:b.lib)||void 0===k?void 0:k.trekkie)||void 0===O?void 0:O.defaultAttributes)||void 0===I?void 0:I.contentLanguage)&&void 0!==L?L:null===(j=null===(x=null===(T=null===(N=null===(P=null===window||void 0===window?void 0:window.ShopifyAnalytics)||void 0===P?void 0:P.lib)||void 0===N?void 0:N.config)||void 0===T?void 0:T.Trekkie)||void 0===x?void 0:x.defaultAttributes)||void 0===j?void 0:j.contentLanguage)&&void 0!==D?D:"en",uuid:null!==(R=window.localStorage.getItem("msUUID"))&&void 0!==R?R:""}}(),r.uuid=c.uuid,r.uid=c.uid,r.merchant_id=c.merchant_id,r.uri=c.uri,[3,5];case 5:return[2,r]}}))}))},c=null!==(l="product")?l:"develop";console.log("===NODE_ENV===","product");var s=r().VITE_BASE_DOMAIN_NO,v=function(n){switch(n){case"develop":return"DEV";case"staging":default:return"TEST";case"preview":return"FAT";case"product":return"PRO"}},p=v(c);console.log("===getEnv===",v(c));var w=function(){var n=null;window.JdpSdk&&(null==(n=new window.JdpSdk.Tracker)||n.setOptions({beforeSend:function(n){return n.act="webmarketaction",n.project_id="spWebMarketAction",n},customDomain:s,queryParams:{_test:1}}));return{report:function(t){window.JdpSdk?null==n||n.report(e({event_id:"",event_name:"",page:"",component:"",module:"",action_type:"",env:p},t)):console.log("load error!")}}};function f(){var n={},t=location.search;return new URLSearchParams(t).forEach((function(t,e){n[e]=t})),n}var h,m=null!=="app"?"app":"APP";!function(n){n[n.PageAll=1]="PageAll",n[n.PageHome=2]="PageHome",n[n.ProductList=3]="ProductList",n[n.ProductDetail=4]="ProductDetail",n[n.Cart=5]="Cart",n[n.ProductQuery=6]="ProductQuery",n[n.UserDetail=7]="UserDetail",n[n.Checkout=8]="Checkout",n[n.NotFound=9]="NotFound"}(h||(h={}));var g,y=function(t,e,o){return t===n.EC1?function(n){var t=f();return n.includes("home")?2:n.includes("product_list")||n.includes("category")?3:n.includes("product_detail")?4:n.includes("cart")?5:n.includes("product_list")&&(null==t?void 0:t.query)?6:n.includes("customer/profile")?7:n.includes("checkout")?8:(n.includes(""),10)}(e):t===n.EC2?function(n){return"Home"===n?2:"Products"===n||"AllCollections"===n?3:"ProductsDetail"===n?4:"Cart"===n?5:"ProductsSearch"===n?6:"Center"===n||"SignIn"===n||"SignUp"===n?7:"Checkout"===n?8:"404"===n?9:10}(e):t===n.SF?function(n,t){return n.includes("home")?2:n.includes("collection")?3:n.includes("product")?4:n.includes("cart")?5:n.includes("searchresults")?6:t.includes("account")?7:10}(e,o):void 0};!function(n){n[n.abandonCart=2]="abandonCart",n[n.app=1]="app"}(g||(g={}));var C,_=function(t){return o(void 0,void 0,void 0,(function(){var o,r,d,l,c,s,v,p,w,C,_,S,A,E,b,k,O,I,L,P,N,T,x,j,D,R,M,H,q,F,J,U,B,V,X;return i(this,(function(i){switch(i.label){case 0:return[4,a()];case 1:return o=i.sent(),r=o.platform,d=o.uri,l=o.url,c=o.merchant_id,s=y(r,d,l),v=JSON.parse(null!==(j=window.sessionStorage.getItem("trackInfo"))&&void 0!==j?j:"{}"),p=null!==(D=v.email)&&void 0!==D?D:"",w=null!==(R=v.phone)&&void 0!==R?R:"",C=t,_=(new Date).valueOf(),S=Intl.DateTimeFormat().resolvedOptions().timeZone,A=f(),E=null==A?void 0:A.utm_campaign,b=null==A?void 0:A.utm_medium,k=null==A?void 0:A.utm_source,O=null==A?void 0:A.sd_id,I=null!==(H=null===(M=null===window||void 0===window?void 0:window.location)||void 0===M?void 0:M.href)&&void 0!==H?H:"",L=e(e({action_type:"BROWSE",sp_uuid:C,ts:_,product_id:"",product_handle:"",product_name:"",page_type:null!=s?s:2,timezone:null!=S?S:"",email:null!=p?p:"",mobile:null!=w?w:"",area_code:"",utm_campaign:E,utm_medium:b,utm_source:k,sd_id:O,cart_token:"",cart:"",href:I},o),{uuid:o.uuid||C,merchant_id:null!==($=c,console.log("===============process======appEnv=:",m),q={abandonCart:"".concat($,"_").concat(g.abandonCart),app:String($)}[m])&&void 0!==q?q:""}),s!==h.ProductDetail?[3,4]:r!==n.EC1?[3,3]:[4,u()];case 2:P=i.sent().product,L.product_id=P.id,i.label=3;case 3:r===n.EC2&&(N=window.Shopline.uri.params.uniqueKey,L.product_handle=N,T=null!==(V=null===(B=null===(U=null===(J=null===(F=window.Shopline.Analytics)||void 0===F?void 0:F.dataLayer)||void 0===J?void 0:J.find((function(n){var t;return"productView"===(null===(t=null==n?void 0:n[1])||void 0===t?void 0:t.name)})))||void 0===U?void 0:U[1])||void 0===B?void 0:B.payload)&&void 0!==V?V:{},L.product_name=null!==(X=null==T?void 0:T.title)&&void 0!==X?X:""),r===n.SF&&(L.product_id=window.ShopifyAnalytics.meta.product.id,(x=window.ShopifyAnalytics.meta.product.variants[0].name).includes(" - ")?L.product_name=x.split(" - ").shift():L.product_name=x),i.label=4;case 4:return[2,L]}var $}))}))};function S(n,t,e,o){n.fetch=function(){var n=t.apply(this,arguments);return n.then((function(n){(null==n?void 0:n.url.includes(e))&&console.log("todo:fetch:res:",n,"url:",e),(null==n?void 0:n.url)===e&&(console.log("fetch:match:url:",e),o())})),n}}function A(n){window.Shopline.Analytics.subscribe("AddToCart",(function(t){console.log("ec2:subscribe==cart:add",t),n(C.add)})),S(window,window.fetch,"".concat(window.location.origin,"/cart/change"),(function(){return console.log("ec2:fetch==cart:change"),n(C.update)})),function(n,t){if(!n||!t)return;window.addEventListener("ajaxReadyStateChange",(function(e){var o,i,r,d,l,u,a;if(4===(null===(o=null==e?void 0:e.detail)||void 0===o?void 0:o.readyState)&&200===(null===(i=null==e?void 0:e.detail)||void 0===i?void 0:i.status))try{if(""===(null===(r=null==e?void 0:e.detail)||void 0===r?void 0:r.responseType)||"text"===(null===(d=null==e?void 0:e.detail)||void 0===d?void 0:d.responseType)){var c=JSON.parse((null===(l=null==e?void 0:e.detail)||void 0===l?void 0:l.responseText)||"{}");(null===(u=null==e?void 0:e.detail)||void 0===u?void 0:u.responseURL.includes(n))&&console.log("todo:xhr:responseURLï¼š",e.detail.responseURL,"url===:",n),(null===(a=null==e?void 0:e.detail)||void 0===a?void 0:a.responseURL)===n&&(console.log("xhr:match:responseURLï¼š",e.detail.responseURL,"url===:",n),t(c))}else console.log("xhr:Error",e)}catch(n){console.log("xhr:Error:2",n)}}))}("".concat(window.location.origin,"/api/carts/ajax-cart/change.js"),(function(){return console.log("ec2:xhr==cart:change"),n(C.update)}))}function E(n,t){if(t){var e=new Object;e.tempOpen=n.prototype.open,e.tempSend=n.prototype.send,e.callback=function(){},n.prototype.open=function(n,t){n||(n=""),t||(t=""),e.tempOpen.apply(this,arguments),e.method=n,e.url=t,"get"==n.toLowerCase()&&(e.data=t.split("?"),e.data=e.data[1])},n.prototype.send=function(n,t){n||(n=""),t||(t=""),e.tempSend.apply(this,arguments),"post"==e.method.toLowerCase()&&(e.data=n),e.callback()},new XMLHttpRequest,window.addEventListener("ajaxReadyStateChange",(function(n){var e,o,i,r,d;if(4===(null===(e=null==n?void 0:n.detail)||void 0===e?void 0:e.readyState)&&200===(null===(o=null==n?void 0:n.detail)||void 0===o?void 0:o.status)&&(""===(null===(i=null==n?void 0:n.detail)||void 0===i?void 0:i.responseType)||"text"===(null===(r=null==n?void 0:n.detail)||void 0===r?void 0:r.responseType)))try{var l=JSON.parse((null===(d=null==n?void 0:n.detail)||void 0===d?void 0:d.responseText)||"{}");t(n.detail.responseURL,l)}catch(n){}}))}}!function(n){n.add="ADD_CART",n.update="UP_CART"}(C||(C={})),function(){if("function"==typeof window.CustomEvent)return!1;function n(n,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var e=document.createEvent("CustomEvent");return e.initCustomEvent(n,t.bubbles,t.cancelable,t.detail),e}n.prototype=window.Event.prototype,window.CustomEvent=n}(),function(){function n(n){var t=new CustomEvent(n,{detail:this});window.dispatchEvent(t)}var t=window.XMLHttpRequest;window.XMLHttpRequest=function(){var e=new t;return e.addEventListener("abort",(function(){n.call(this,"ajaxAbort")}),!1),e.addEventListener("error",(function(){n.call(this,"ajaxError")}),!1),e.addEventListener("load",(function(){n.call(this,"ajaxLoad")}),!1),e.addEventListener("loadstart",(function(){n.call(this,"ajaxLoadStart")}),!1),e.addEventListener("progress",(function(){n.call(this,"ajaxProgress")}),!1),e.addEventListener("timeout",(function(){n.call(this,"ajaxTimeout")}),!1),e.addEventListener("loadend",(function(){n.call(this,"ajaxLoadEnd")}),!1),e.addEventListener("readystatechange",(function(){n.call(this,"ajaxReadyStateChange")}),!1),e}}();var b=function(t){return o(void 0,void 0,void 0,(function(){var o,r,d,l,u,c,s;return i(this,(function(i){switch(i.label){case 0:return[4,a()];case 1:return o=i.sent(),r=o.platform,d=o.merchant_id,[4,_(t)];case 2:return l=i.sent(),u=w().report,r===n.EC1&&(c=!0,E(XMLHttpRequest,(function(n,t){console.log("ec1:ajaxReadyStateChange==url:",n);var o=n.includes("/api/merchants/".concat(d,"/cart")),i=n.includes("/api/merchants/".concat(d,"/cart/items"));if(o&&!i){if(!c)return;c=!1,setTimeout((function(){return c=!0}),1e3);var r=t.data,a=r.id,s=r.items,v=[];null==s||s.map((function(n){v.push({spuId:n.product_id,skuId:n._id,price:n.price.dollars,quantity:n.quantity})}));var p={cart_token:a,products:v};l.cart=JSON.stringify(p),l.action_type=C.update,u(e(e({},l),{ts:(new Date).valueOf()}))}}))),r===n.EC2&&A((function(n){return t=function(t){console.log("ec2:cart:detail==type",n,"cart:",t),l.cart=JSON.stringify(t),l.action_type=n,u(e(e({},l),{ts:(new Date).valueOf()}))},console.log("sp:::ajax:::ajax-cart"),void fetch("https://".concat(window.location.host,"/api/carts/ajax-cart")).then((function(n){return n.json()})).then((function(n){var e=n.token,o=n.total_price,i=n.items,r=[];null==i||i.map((function(n){r.push({productName:n.product_title,spuId:n.product_id,skuId:n.id,price:n.price,quantity:n.quantity})})),t({cart_token:e,total_price:o,products:r})}));var t})),r===n.SF&&(s=function(n){var t;t=function(t){l.cart=JSON.stringify(t),l.action_type=n,u(e(e({},l),{ts:(new Date).valueOf()}))},console.log("sp:::ajax:::ajax-cart"),fetch(window.Shopify.routes.root+"cart.js").then((function(n){return n.json()})).then((function(n){var e=n.total_price,o=n.items,i=n.token;(null==i?void 0:i.includes("?"))&&(i=i.split("?")[0]);var r=[];null==o||o.map((function(n){r.push({productName:n.product_title,spuId:n.product_id,skuId:n.id,price:Number.isFinite(n.price)?n.price/100:n.price,quantity:n.quantity})}));var d={cart_token:i,total_price:Number.isFinite(e)?e/100:e,products:r};t(d)}))},S(window,window.fetch,"".concat(window.location.origin,"/cart/add"),(function(){return s(C.add)})),S(window,window.fetch,"".concat(window.location.origin,"/cart/change"),(function(){return s(C.update)})),S(window,window.fetch,"".concat(window.location.origin,"/cart/add.js"),(function(){return s(C.add)})),S(window,window.fetch,"".concat(window.location.origin,"/cart/change.js"),(function(){return s(C.update)}))),[2]}}))}))},k=function(n,e){var o,i=JSON.parse(null!==(o=window.sessionStorage.getItem("trackInfo"))&&void 0!==o?o:"{}");n===t.EMAIL&&(i.email=e,window.sessionStorage.setItem("trackInfo",JSON.stringify(i))),n===t.PHONE&&(i.phone=e,window.sessionStorage.setItem("trackInfo",JSON.stringify(i)))},O=function(r){return o(void 0,void 0,void 0,(function(){var o,d,l,u,c,s,v;return i(this,(function(i){switch(i.label){case 0:return[4,a()];case 1:return o=i.sent(),d=o.platform,[4,_(r)];case 2:return l=i.sent(),u=w().report,c=function(n,t,e){if(e||2===arguments.length)for(var o,i=0,r=t.length;i<r;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return n.concat(o||Array.prototype.slice.call(t))}([],function(n,t){var e="function"==typeof Symbol&&n[Symbol.iterator];if(!e)return n;var o,i,r=e.call(n),d=[];try{for(;(void 0===t||t-- >0)&&!(o=r.next()).done;)d.push(o.value)}catch(n){i={error:n}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(i)throw i.error}}return d}(document.querySelectorAll("input")),!1),s=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,v=/^(?:[0-9] ?){6,14}[0-9]$/,null==c||c.map((function(o){o instanceof HTMLInputElement&&(o.onblur=function(i){var r,a,c=i.target.value;if(s.test(c)&&(k(t.EMAIL,c),l.email=c,u(e(e({},l),{ts:(new Date).valueOf()}))),v.test(c))if(d===n.EC1){var p,w,f=null,h=document.getElementsByClassName("customer-form")[0],m=document.getElementsByClassName("mobile-phone-control")[0];if(f=h||m)(w=null!==(r=null==(p=f.getElementsByClassName("iti__dial-code")[0])?void 0:p.innerHTML.replace(/^\+|\s+|\s+$/g,"").replace(/\+/g,""))&&void 0!==r?r:"")&&f.contains(o)&&(k(t.PHONE,c),l.mobile=c,l.area_code=w,u(e(e({},l),{ts:(new Date).valueOf()})));else k(t.PHONE,c),l.mobile=c,(w=null!==(a=null==(p=document.getElementsByClassName("iti__dial-code")[0])?void 0:p.innerHTML.replace(/^\+|\s+|\s+$/g,"").replace(/\+/g,""))&&void 0!==a?a:"")&&(l.area_code=w),u(e(e({},l),{ts:(new Date).valueOf()}))}else k(t.PHONE,c),l.mobile=c,u(e(e({},l),{ts:(new Date).valueOf()}))})})),[2]}}))}))};function I(n,t){return(65535&n)*t+(((n>>>16)*t&65535)<<16)}function L(n,t){return n<<t|n>>>32-t}function P(n){return n=I(n^=n>>>16,2246822507),n=I(n^=n>>>13,3266489909),n^=n>>>16}var N=function(n,t){t=t||0;for(var e=(n=n||"").length%16,o=n.length-e,i=t,r=t,d=t,l=t,u=0,a=0,c=0,s=0,v=597399067,p=2869860233,w=951274213,f=2716044179,h=0;h<o;h+=16)u=255&n.charCodeAt(h)|(255&n.charCodeAt(h+1))<<8|(255&n.charCodeAt(h+2))<<16|(255&n.charCodeAt(h+3))<<24,a=255&n.charCodeAt(h+4)|(255&n.charCodeAt(h+5))<<8|(255&n.charCodeAt(h+6))<<16|(255&n.charCodeAt(h+7))<<24,c=255&n.charCodeAt(h+8)|(255&n.charCodeAt(h+9))<<8|(255&n.charCodeAt(h+10))<<16|(255&n.charCodeAt(h+11))<<24,s=255&n.charCodeAt(h+12)|(255&n.charCodeAt(h+13))<<8|(255&n.charCodeAt(h+14))<<16|(255&n.charCodeAt(h+15))<<24,u=L(u=I(u,v),15),i=L(i^=u=I(u,p),19),i=I(i+=r,5)+1444728091,a=L(a=I(a,p),16),r=L(r^=a=I(a,w),17),r=I(r+=d,5)+197830471,c=L(c=I(c,w),17),d=L(d^=c=I(c,f),15),d=I(d+=l,5)+2530024501,s=L(s=I(s,f),18),l=L(l^=s=I(s,v),13),l=I(l+=i,5)+850148119;switch(u=0,a=0,c=0,s=0,e){case 15:s^=n.charCodeAt(h+14)<<16;case 14:s^=n.charCodeAt(h+13)<<8;case 13:s=I(s^=n.charCodeAt(h+12),f),l^=s=I(s=L(s,18),v);case 12:c^=n.charCodeAt(h+11)<<24;case 11:c^=n.charCodeAt(h+10)<<16;case 10:c^=n.charCodeAt(h+9)<<8;case 9:c=I(c^=n.charCodeAt(h+8),w),d^=c=I(c=L(c,17),f);case 8:a^=n.charCodeAt(h+7)<<24;case 7:a^=n.charCodeAt(h+6)<<16;case 6:a^=n.charCodeAt(h+5)<<8;case 5:a=I(a^=n.charCodeAt(h+4),p),r^=a=I(a=L(a,16),w);case 4:u^=n.charCodeAt(h+3)<<24;case 3:u^=n.charCodeAt(h+2)<<16;case 2:u^=n.charCodeAt(h+1)<<8;case 1:u=I(u^=n.charCodeAt(h),v),i^=u=I(u=L(u,15),p)}return i^=n.length,i+=r^=n.length,i+=d^=n.length,r+=i+=l^=n.length,d+=i,l+=i,i=P(i),i+=r=P(r),i+=d=P(d),r+=i+=l=P(l),d+=i,l+=i,("00000000"+(i>>>0).toString(16)).slice(-8)+("00000000"+(r>>>0).toString(16)).slice(-8)+("00000000"+(d>>>0).toString(16)).slice(-8)+("00000000"+(l>>>0).toString(16)).slice(-8)},T=function(n){switch(n){case"develop":default:return"dev";case"staging":return"test";case"preview":return"pre";case"product":return"pro"}},x=function(n,t){return new Promise((function(e){var r=document.createElement("script");r.src=n,r.type="text/javascript",r.crossOrigin="anonymous",r.onload=function(){return o(void 0,void 0,void 0,(function(){var n;return i(this,(function(o){switch(o.label){case 0:return[4,t()];case 1:return n=o.sent(),e(n),[2]}}))}))},r.onerror=function(n){console.log("%c loadScript ðŸ¥• ----load-error","color:#ed9ec7",n)},document.body.appendChild(r)}))},j=function(){return o(void 0,void 0,void 0,(function(){return i(this,(function(n){return[2,new Promise((function(n){return o(void 0,void 0,void 0,(function(){var t,e;return i(this,(function(o){try{null==(t=window.DeviceFingerprint({env:T(null!==(e="product")?e:"product"),appCode:"m3tdgo"}))||t.getTokenAsync().then((function(t){n(t)}))}catch(t){console.log("===getUuidValue=====token=2=error=====:",t),n("")}return[2]}))}))}))]}))}))},D=function(){return o(void 0,void 0,void 0,(function(){var t,r,d,l,u,c;return i(this,(function(s){switch(s.label){case 0:return[4,o(void 0,void 0,void 0,(function(){var n;return i(this,(function(t){switch(t.label){case 0:return(null===window||void 0===window?void 0:window.DeviceFingerprint)?[4,j()]:[3,2];case 1:case 3:return n=t.sent(),[2,{fingerprint:N(n)}];case 2:return[4,x("https://r2cdn.myshopline.com/static/rs/adff/prod/latest/bundle.iife.js",j)]}}))}))];case 1:return t=s.sent().fingerprint,[4,a()];case 2:return r=s.sent(),d=r.platform,[4,_(t)];case 3:return l=s.sent(),(u=w().report)(e({},l)),[4,O(t)];case 4:return s.sent(),d===n.EC2&&(c=!0,E(XMLHttpRequest,(function(n){var t,o,i;if(n.includes("/leproxy/api/user/front/users/footersub")){if(!c)return;c=!1,setTimeout((function(){return c=!0}),1e3);var r=JSON.parse(null!==(t=window.sessionStorage.getItem("trackInfo"))&&void 0!==t?t:"{}");l.email=null!==(o=r.email)&&void 0!==o?o:"",r.phone=null!==(i=r.phone)&&void 0!==i?i:"",u(e(e({},l),{ts:(new Date).valueOf()}))}}))),b(t),[2]}}))}))};window.JdpSdk?window.MARKET_ACTION||(window.MARKET_ACTION=!0,console.log("trcker-init"),D()):!window.JdpSdk&&x("https://cdn.myshopline.com/sl/sdk/jdpsdk.min.js",(function(){return o(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,D()];case 1:return n.sent(),[2,Promise.resolve("")]}}))}))}))}));
