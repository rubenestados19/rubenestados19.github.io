!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).HdSdk={})}(this,(function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};var r,o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function i(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function a(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function c(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||t)}var u=new Uint8Array(16);function d(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(u)}var p=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function l(e){return"string"==typeof e&&p.test(e)}for(var f=[],v=0;v<256;++v)f.push((v+256).toString(16).substr(1));function h(e,t,n){var r=(e=e||{}).random||(e.rng||d)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(f[e[t+0]]+f[e[t+1]]+f[e[t+2]]+f[e[t+3]]+"-"+f[e[t+4]]+f[e[t+5]]+"-"+f[e[t+6]]+f[e[t+7]]+"-"+f[e[t+8]]+f[e[t+9]]+"-"+f[e[t+10]]+f[e[t+11]]+f[e[t+12]]+f[e[t+13]]+f[e[t+14]]+f[e[t+15]]).toLowerCase();if(!l(n))throw TypeError("Stringified UUID is invalid");return n}(r)}function g(e){return e&&"[object Function]"==={}.toString.call(e)}function m(e){return e instanceof Error?e:new Error(String(e))}var y="106",_=["PageView","HomePageView","ViewProductList","ViewSearchResults","PageLeave","PageDuration","HeartBeat","View","ViewSuccess","ViewContent","AddToCart","InitiateCheckout","AddCustomerInfo","AddShippingInfo","AddPaymentInfo","Purchase","SearchResults","CompleteRegistration","Search","Lead","Login","SelectContent","RemoveFromCart","ViewCart","ViewItem","ViewItemList"],w=["View","ViewSuccess"],b=["InitiateCheckout","AddCustomerInfo","AddShippingInfo","AddPaymentInfo","Purchase"],S={event_name:function(e){return"string"==typeof e&&/^[a-zA-Z_]+$/.test(e)},event_id:function(e){return"number"==typeof e},app_id:function(e){return!!e},event_ext_info:function(e){return void 0===e||function(e){return"object"===t(e)&&!Array.isArray(e)&&null!==e}(e)}};function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(e,t,n){return t&&T(e.prototype,t),n&&T(e,n),e}function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){return!t||"object"!==L(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function R(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function A(e){return function(e){if(Array.isArray(e))return D(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function N(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){C(i,r,o,a,s,"next",e)}function s(e){C(i,r,o,a,s,"throw",e)}a(void 0)}))}}function M(e,t,n){return(M="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=x(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}var j="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function U(e,t){return e(t={exports:{}},t.exports),t.exports}var H=U((function(e){var n=function(e){var n,r=Object.prototype,o=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,i=Object.create(o.prototype),a=new E(r||[]);return i._invoke=function(e,t,n){var r=l;return function(o,i){if(r===v)throw new Error("Generator is already running");if(r===h){if("throw"===o)throw i;return P()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=L(a,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===l)throw r=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=v;var c=p(e,t,n);if("normal"===c.type){if(r=n.done?h:f,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=h,n.method="throw",n.arg=c.arg)}}}(e,n,a),i}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=d;var l="suspendedStart",f="suspendedYield",v="executing",h="completed",g={};function m(){}function y(){}function _(){}var w={};w[a]=function(){return this};var b=Object.getPrototypeOf,S=b&&b(b(R([])));S&&S!==r&&o.call(S,a)&&(w=S);var k=_.prototype=m.prototype=Object.create(w);function T(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,n){function r(i,a,s,c){var u=p(e[i],e,a);if("throw"!==u.type){var d=u.arg,l=d.value;return l&&"object"===t(l)&&o.call(l,"__await")?n.resolve(l.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):n.resolve(l).then((function(e){d.value=e,s(d)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var i;this._invoke=function(e,t){function o(){return new n((function(n,o){r(e,t,n,o)}))}return i=i?i.then(o,o):o()}}function L(e,t){var r=e.iterator[t.method];if(r===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,L(e,t),"throw"===t.method))return g;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var o=p(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,g;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,g):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function R(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(o.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return i.next=i}}return{next:P}}function P(){return{value:n,done:!0}}return y.prototype=k.constructor=_,_.constructor=y,y.displayName=u(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,u(e,c,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},T(O.prototype),O.prototype[s]=function(){return this},e.AsyncIterator=O,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new O(d(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(k),u(k,c,"Generator"),k[a]=function(){return this},k.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=R,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,o){return s.type="throw",s.arg=e,t.next=r,o&&(t.method="next",t.arg=n),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),x(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;x(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:R(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),g}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}}));function V(e){return JSON.parse(JSON.stringify(e))}var F="application/x-www-form-urlencoded",B=49152,q="The query length cannot exceed ".concat(48,"K");function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var z={useHttps:!0,useRetry:!0,retryTimes:1,maxRequest:5},J=function(){return O((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};k(this,e),this.configure(t),this.override(n)}),[{key:"configure",value:function(e){var t,n=Object.assign({},this.options,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e));0<n.retryTimes&&n.retryTimes<4||(n.retryTimes=1),-1!==(null===(t=window.location)||void 0===t||null===(t=t.protocol)||void 0===t?void 0:t.indexOf("https"))&&(n.useHttps=!0),this.options=n}},{key:"merge",value:function(e){this.data=Object.assign({},this.data,e)}},{key:"override",value:function(e){this.data=V(e)}},{key:"use",value:function(e,t){if("function"==typeof t)switch(e){case"url":this.urlInterceptor=t;break;case"request":this.requestInterceptor=t}}},{key:"processTrackingData",value:function(e){var t=Object.assign({},this.data,e),n=this.completeTrackingData(t);return this.pretreateTrackingData(n)}},{key:"encodeTrackingData",value:function(e){return function(e){if("object"!==L(e))return e;var t=function(e,n){var r=[];if("object"===L(e))return Object.keys(e).forEach((function(o){var i=e[o];"object"===L(i)?r=""!=n?r.concat(t(i,n+"["+o+"]")):r.concat(t(i,o)):void 0!==i&&(""!=n?r.push(n,"[",o,"]","=",encodeURIComponent(i),"&"):r.push(o,"=",encodeURIComponent(i),"&"))})),r};return t(e,"").slice(0,-1).join("")}(this.formatTrackingData(e))}},{key:"completeTrackingData",value:function(e){var t,n,r,o,i={act:"websdkentmaster",time:Math.floor((new Date).getTime()/1e3),domain:null===(t=window)||void 0===t||null===(t=t.location)||void 0===t?void 0:t.hostname,url:null===(n=window)||void 0===n||null===(n=n.location)||void 0===n?void 0:n.href,ua:null===(r=window)||void 0===r||null===(r=r.navigator)||void 0===r?void 0:r.userAgent,ref:null===(o=document)||void 0===o?void 0:o.referrer,data_id:h(),request_time:Date.now()};return Object.assign({},i,e)}},{key:"formatMoreInfoData",value:function(e){var t,n={language:null===(t=window)||void 0===t?void 0:t.navigator.language,is_mobile:this.getIsMobile()};return Object.assign({},n,e)}},{key:"getMobile",value:function(){var e,t=null===(e=window)||void 0===e?void 0:e.navigator.userAgent,n=!t.match(/(iPad).*OS\s([\d_]+)/)&&t.match(/(iPhone\sOS)\s([\d_]+)/),r=t.match(/(Android)\s+([\d.]+)/);return n||r}},{key:"getIsMobile",value:function(){return this.getMobile()?"101":"102"}},{key:"pretreateTrackingData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options,n=this.requestInterceptor;return"function"==typeof n?n(e,t):e}},{key:"formatTrackingData",value:function(e){var t=V(e);return t.moreinfo||(t.moreinfo={}),"object"===L(t.moreinfo)&&(t.moreinfo=this.formatMoreInfoData(t.moreinfo),t.moreinfo=JSON.stringify(t.moreinfo)),"localhost"===t.domain&&(t.domain=""),t}},{key:"destory",value:function(){this.data=void 0,this.options=void 0,this.urlInterceptor=void 0,this.requestInterceptor=void 0}}])}(),Y=new Array(15);function K(e,t){return 506832829*e>>>t}function W(e,t){return e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24)}function $(e,t,n){return e[t]===e[n]&&e[t+1]===e[n+1]&&e[t+2]===e[n+2]&&e[t+3]===e[n+3]}function X(e,t,n,r,o){return n<=60?(r[o]=n-1<<2,o+=1):n<256?(r[o]=240,r[o+1]=n-1,o+=2):(r[o]=244,r[o+1]=n-1&255,r[o+2]=n-1>>>8,o+=3),function(e,t,n,r,o){for(var i=0;i<o;i++)n[r+i]=e[t+i]}(e,t,r,o,n),o+n}function Z(e,t,n,r){return r<12&&n<2048?(e[t]=1+(r-4<<2)+(n>>>8<<5),e[t+1]=255&n,t+2):(e[t]=2+(r-1<<2),e[t+1]=255&n,e[t+2]=n>>>8,t+3)}function Q(e,t,n,r){for(;r>=68;)t=Z(e,t,n,64),r-=64;return r>64&&(t=Z(e,t,n,60),r-=60),Z(e,t,n,r)}function ee(e,t,n,r,o){for(var i=1;1<<i<=n&&i<=14;)i+=1;var a=32-(i-=1);void 0===Y[i]&&(Y[i]=new Uint16Array(1<<i));for(var s=Y[i],c=0;c<s.length;c++)s[c]=0;var u,d,p,l,f,v,h,g,m,y,_=t+n,w=t,b=t,S=!0;if(n>=15)for(u=_-15,p=K(W(e,t+=1),a);S;){v=32,l=t;do{if(d=p,h=v>>>5,v+=1,l=(t=l)+h,t>u){S=!1;break}p=K(W(e,l),a),f=w+s[d],s[d]=t-w}while(!$(e,t,f));if(!S)break;o=X(e,b,t-b,r,o);do{for(g=t,m=4;t+m<_&&e[t+m]===e[f+m];)m+=1;if(t+=m,o=Q(r,o,g-f,m),b=t,t>=u){S=!1;break}s[K(W(e,t-1),a)]=t-1-w,f=w+s[y=K(W(e,t),a)],s[y]=t-w}while($(e,t,f));if(!S)break;p=K(W(e,t+=1),a)}return b<_&&(o=X(e,b,_-b,r,o)),o}var te=function(){return O((function e(t){k(this,e),this.sources=t}),[{key:"maxCompressedLength",value:function(){var e=this.sources.length;return 32+e+Math.floor(e/6)}},{key:"compressToBuffer",value:function(e){var t,n=this.sources,r=n.length,o=0,i=0;for(i=function(e,t,n){do{t[n]=127&e,(e>>>=7)>0&&(t[n]+=128),n+=1}while(e>0);return n}(r,e,i);o<r;)i=ee(n,o,t=Math.min(r-o,65536),e,i),o+=t;return i}}])}();function ne(e){return e instanceof Uint8Array}function re(e){return e instanceof ArrayBuffer}function oe(e){if(!ne(e)&&!re(e)&&(t=e,!Buffer.isBuffer(t)))throw new TypeError("Argument compressed must be type of ArrayBuffer, Buffer, or Uint8Array");var t,n,r=!1,o=!1;ne(e)?(r=!0,n=e):re(e)&&(o=!0,n=new Uint8Array(e));var i,a,s,c=new te(n),u=c.maxCompressedLength();return r?(i=new Uint8Array(u),s=c.compressToBuffer(i)):o?(i=new ArrayBuffer(u),a=new Uint8Array(i),s=c.compressToBuffer(a)):(i=Buffer.alloc(u),s=c.compressToBuffer(i)),i.slice(0,s)}function ie(e){return oe(function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t.buffer}(e))}var ae=Math.pow(2,31)-1;function se(e){return new Promise((function(t){var n=Number.isSafeInteger(e)&&e>0?e:0;setTimeout(t,n>ae?ae:n)}))}function ce(e,t,n){return t=x(t),I(e,ue()?Reflect.construct(t,n||[],x(e).constructor):t.apply(e,n))}function ue(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ue=function(){return!!e})()}function de(e,t,n,r){var o=M(x(1&r?e.prototype:e),t,n);return 2&r&&"function"==typeof o?function(e){return o.apply(n,e)}:o}var pe=Object.assign({},z,{wait:"immediately"}),le=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return k(this,t),(e=ce(this,t,[n,r])).trackingTasks=[],e.trackingReportors=[],e}return R(t,e),O(t,[{key:"report",value:(i=N(H.mark((function e(t){var n,r,o=arguments;return H.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>1&&void 0!==o[1]&&o[1],Array.isArray(t)){e.next=3;break}return e.abrupt("return",this.report([t],n));case 3:if(this.addTask.apply(this,A(t)),!n){e.next=7;break}return r=this.trackingTasks.pop(),e.abrupt("return",this.tryReport([r]));case 7:return e.abrupt("return",this.runReport());case 8:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"post",value:(o=N(H.mark((function e(){var t;return H.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t=this.freeTrackingTask()).length>0)){e.next=5;break}return this.tryReport(t),e.abrupt("continue",0);case 5:return e.abrupt("break",8);case 8:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"use",value:function(e,n){de(t,"use",this,3)([e,n])}},{key:"addTask",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){var n=e.processTrackingData(t),r=e.encodeTrackingData(n);if(e.validTrackingData(r,n)){var o={encoded:r,source:n};e.trackingTasks.push(o)}}))}},{key:"runReport",value:(r=N(H.mark((function e(){var n,r,o,i,a;return H.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.options,r=n.maxRequest,o=n.wait,!(this.trackingReportors.length>=r)){e.next=4;break}return e.next=4,Promise.all(this.trackingReportors);case 4:if(!t.supported){e.next=13;break}if("nextTick"!==o){e.next=10;break}return e.next=8,Promise.resolve();case 8:e.next=13;break;case 10:if("number"!=typeof o){e.next=13;break}return e.next=13,se(o);case 13:if(!((i=this.freeTrackingTask()).length>0)){e.next=18;break}return a=this.tryReport(i),e.next=18,this.pushReport(a);case 18:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"freeTrackingTask",value:function(){var e;if(null===(e=this.trackingTasks)||void 0===e||!e.length)return[];for(var t=1,n=0;n<this.trackingTasks.length;n++){if((t+=this.trackingTasks[n].encoded.length+3)>B)return this.trackingTasks.splice(0,n)}return this.trackingTasks.splice(0)}},{key:"tryReport",value:(n=N(H.mark((function e(t){var n,r,o,i,a,s,c,u,d=arguments;return H.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.length>1&&void 0!==d[1]?d[1]:0,e.prev=1,r=this.options,o=r.useHttps,i=r.domain,a="http".concat(!1!==o?"s":"","://").concat(i),e.next=6,this.delegateRequest(a,t);case 6:e.next=16;break;case 8:if(e.prev=8,e.t0=e.catch(1),s=this.options,c=s.useRetry,u=s.retryTimes,!(!0===c&&u>n)){e.next=15;break}return e.next=14,this.tryReport(t,n+1);case 14:return e.abrupt("return",e.sent);case 15:return e.abrupt("return",Promise.reject(e.t0));case 16:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(e){return n.apply(this,arguments)})},{key:"pushReport",value:function(e){var t=this,n=function(){var n=t.trackingReportors.indexOf(e);t.trackingReportors.splice(n,1)},r=e.then(n).catch((function(e){return n(),Promise.reject(e)}));return this.trackingReportors.push(r),r}},{key:"delegateRequest",value:function(e,t){if(!Array.isArray(t)){var n=this.interceptUrl("".concat(e,"/").concat("n.gif"),t);return this.options.skipReport?Promise.resolve():this.send(n,t.encoded)}return 1===t.length?this.delegateRequest(e,t[0]):this.mergeRequest(e,t)}},{key:"mergeRequest",value:function(e,t){var n=this,r=[];if("function"==typeof this.options.mergeTransformer){var o=t.map((function(e){return e.source}));r=this.options.mergeTransformer(o).map((function(e){return n.encodeTrackingData(e)}))}else r=t.map((function(e){return e.encoded}));var i=this.compressTrackingDatas(r),a=this.interceptUrl("".concat(e,"/").concat("o.gif","?cmp=1&enc=b64"),t);return this.options.skipReport?Promise.resolve():this.send(a,i)}},{key:"interceptUrl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.options;return"function"==typeof this.urlInterceptor?this.urlInterceptor(e,t,n):e}},{key:"compressTrackingDatas",value:function(e){var t=ie(JSON.stringify(e)),n=String.fromCharCode.apply(null,new Uint8Array(t));return btoa(n)}},{key:"validTrackingData",value:function(e,t){var n,r,o;if("function"==typeof this.options.validateTrackingData&&!this.options.validateTrackingData(e,t))return!1;return!(e.length>B)||(n=q,"function"==typeof(null===(r=console)||void 0===r?void 0:r.error)?console.error(n):"function"==typeof(null===(o=console)||void 0===o?void 0:o.log)&&console.log(n),!1)}},{key:"destory",value:function(){de(t,"destory",this,3)([]),this.trackingTasks.splice(0),this.trackingReportors.splice(0),this.trackingTasks=void 0,this.trackingReportors=void 0}}]);var n,r,o,i}(J);P(le,"supported","function"==typeof btoa&&"undefined"!=typeof Uint16Array);var fe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"http request fail.",n=new Error(t),r=e.xhr,o={type:"ajax",response:null,event:e.event,data:e.data,xhr:r,status:r.status,responseText:r.responseText};try{o.response=JSON.parse(r.responseText)}catch(e){}return Object.assign(n,{detail:o})};function ve(e,t,n){return t=x(t),I(e,he()?Reflect.construct(t,n||[],x(e).constructor):t.apply(e,n))}function he(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(he=function(){return!!e})()}var ge=function(e){function t(){return k(this,t),ve(this,t,arguments)}return R(t,e),O(t,[{key:"send",value:function(e,t){return function(e,t){return new Promise((function(n,r){var o=new XMLHttpRequest;o.open("POST",e),o.onerror=function(e){var n=fe({xhr:o,event:e,data:t});r(n)},o.onreadystatechange=function(e){if(o.readyState===XMLHttpRequest.DONE&&200===o.status)n();else{var i=fe({xhr:o,event:e,data:t});(o.status>=500||o.status>=402&&o.status<=420||400==o.status||401==o.status)&&r(i)}},o.setRequestHeader("Content-Type",F),o.withCredentials=!1,o.send(t)}))}(e,t)}}])}(le);P(ge,"supported","undefined"!=typeof XMLHttpRequest);var me,ye=function(){var e=N(H.mark((function e(t,n){var r;return H.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new Blob([n],{type:F}),navigator.sendBeacon(t,r)){e.next=4;break}throw new Error("Send beacon fail.");case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function _e(e,t,n){return t=x(t),I(e,we()?Reflect.construct(t,n||[],x(e).constructor):t.apply(e,n))}function we(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(we=function(){return!!e})()}var be=function(e){function t(){return k(this,t),_e(this,t,arguments)}return R(t,e),O(t,[{key:"send",value:function(e,t){return ye(e,t)}}])}(le);function Se(e,t){var n=new be(e,t),r=new ge(e,t),o={httpInstance:r,beaconInstance:n};return be.supported?Object.assign(n,o):ge.supported?Object.assign(r,o):void 0}function ke(e,t){for(var n={},r=0,o=t.length;r<o;r++){var i=t[r];i&&Object.prototype.hasOwnProperty.call(e,i)&&(n["".concat(i)]=e[i],delete e[i])}return n}function Te(e){return"".concat(e).startsWith("_")?e:"_".concat(e)}function Oe(e,t){var n;null===(n=window.__SL_Track__)||void 0===n||n.error("ECDATA",{owner:"HdSdk_ShopTracker",msg:e,error:null==t?void 0:t.message})}function Le(){var e,t,n=null===(e=window.Shopline)||void 0===e?void 0:e.storeId,r=(null===(t=window.SL_Report)||void 0===t?void 0:t.storageTypeMap)||{};if(!n)return"localStorage";var o=Object.entries(r).find((function(e){return e[0],e[1].includes(n)}));return(null==o?void 0:o[0])||"localStorage"}P(be,"supported","function"==typeof(null===(me=navigator)||void 0===me?void 0:me.sendBeacon));var Ie,xe,Ee,Re,Pe,De,Ae,Ce,Ne,Me=U((function(e,t){var n;n=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(r){function o(){}function i(t,n,i){if("undefined"!=typeof document){"number"==typeof(i=e({path:"/"},o.defaults,i)).expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var a=JSON.stringify(n);/^[\{\[]/.test(a)&&(n=a)}catch(e){}n=r.write?r.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in i)i[c]&&(s+="; "+c,!0!==i[c]&&(s+="="+i[c].split(";")[0]));return document.cookie=t+"="+n+s}}function a(e,n){if("undefined"!=typeof document){for(var o={},i=document.cookie?document.cookie.split("; "):[],a=0;a<i.length;a++){var s=i[a].split("="),c=s.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=t(s[0]);if(c=(r.read||r)(c,u)||t(c),n)try{c=JSON.parse(c)}catch(e){}if(o[u]=c,e===u)break}catch(e){}}return e?o[e]:o}}return o.set=i,o.get=function(e){return a(e,!1)},o.getJSON=function(e){return a(e,!0)},o.remove=function(t,n){i(t,"",e(n,{expires:-1}))},o.defaults={},o.withConverter=n,o}((function(){}))},e.exports=n()})),je=function(e,t){ut&&Oe("cookieStorage_".concat(e),t)},Ue=function(){function e(e){void 0===e&&(e={}),this.defaultOptions={path:"/",expires:365},this.defaultOptions=o(o({},this.defaultOptions),e)}return e.prototype.set=function(e,t,n,r,i){var a;void 0===n&&(n=30),void 0===r&&(r=0),void 0===i&&(i={});var s=o(o({},this.defaultOptions),i),c={value:t,timeOffset:r,maxAge:null};if(n){var u=Date.now()-(r||0)+n*it;c.maxAge=u}try{Me.set(e,JSON.stringify(c),{path:s.path,expires:s.expires})}catch(e){je("set",e)}null===(a=i.callback)||void 0===a||a.call(i,c)},e.prototype.getRaw=function(e){var t={value:null,maxAge:null,timeOffset:0};try{var n=Me.get(e),r=n?JSON.parse(n):null;r&&(t=r)}catch(e){je("getRaw",e)}return t},e.prototype.append=function(e,t,n){var r=void 0;try{var o=this.getRaw(e);o.value&&(r=Object.assign(o.value,t),this.set(e,r))}catch(e){je("append",e)}return r&&(null==n||n(r)),r},e.prototype.remove=function(e){Me.remove(e,{path:this.defaultOptions.path})},e}(),He="__hdsdk::test",Ve=function(e,t){ut&&Oe(e,t)},Fe=function(){var e=null;if(ut){var t=Le();if(t&&"cookie"!==t)e=t;else try{localStorage.setItem(He,"1");var n=localStorage.getItem(He);localStorage.removeItem(He),"1"===n?e="localStorage":(e="sessionStorage",Ve("sessionStorage_1"))}catch(t){e="sessionStorage",Ve("sessionStorage_2",t)}}return"sessionStorage"===e?sessionStorage:localStorage}(),Be=function(e){var t=null;try{var n=Fe.getItem(e);n&&(t=JSON.parse(n))}catch(e){Ve("getStorageData_parseError",e)}return t},qe=function(e,t){var n=JSON.stringify(t);try{localStorage.setItem(e,n)}catch(e){Ve("setStorageData_error",e)}ut&&sessionStorage.setItem(e,n)},Ge=new(function(){function e(){}return e.prototype.get=function(e){var t;try{var n=Be(e);n&&n.value&&(n.maxAge?n.maxAge>Date.now()-(n.timeOffset||0)?t=n.value:this.remove(e):t=n.value)}catch(e){}return t},e.prototype.set=function(e,t,n,r,o){var i;void 0===r&&(r=0);var a={value:t,maxAge:n?Date.now()-r+60*n*1e3:null,timeOffset:r};try{qe(e,a)}catch(e){Ve("set",e)}null===(i=null==o?void 0:o.callback)||void 0===i||i.call(o,a)},e.prototype.remove=function(e){!function(e){localStorage.removeItem(e),ut&&sessionStorage.removeItem(e)}(e)},e.prototype.getRaw=function(e){var t={value:null,maxAge:null,timeOffset:0};try{var n=Be(e);n&&n.value&&(t=n)}catch(e){}return t},e.prototype.isExpired=function(e){try{var t=Be(e);return!t||!t.value||!(!t.maxAge||t.maxAge&&t.maxAge>(Date.now()-t.timeOffset||0))}catch(e){}return!0},e.prototype.append=function(e,t,n){var r=Be(e);try{if(r&&r.value)return Object.assign(r.value,t),qe(e,r),null==n||n(r),r.value}catch(e){Ve("append",e)}r&&(null==n||n(r))},e}()),ze="tracker_cid",Je="tracker_sid",Ye="osudb_uid",Ke="merchant_id",We="store_id",$e={wait:20},Xe="admintoC",Ze="webslcodetrack",Qe="websdkprotocol",et="webslplugincodetrack",tt="-999",nt=["preview","product"],rt="tracker_landing",ot=["merchant_id","user_id","version","store_timezone","user_timezone","store_region"],it=6e4,at=60*it*24,st=(Ie=navigator.userAgent,xe=/iPad|iPhone|iPod/.test(Ie),Ee=/FBIOS/.test(Ie),xe&&Ee),ct=function(){var e;return(null===(e=window.SL_Report)||void 0===e?void 0:e.isHitSunfereGray)||!1}(),ut=st&&ct,dt="941223b422c64b1d8c6fb927750fbc81",pt="1e21d61b1992449590ac489a461595b4",lt=Le(),ft=ut&&"cookie"===lt,vt=new Ue,ht=ft?vt:Ge,gt="dc_new_stat_tracker_nsid",mt=Object.freeze({__proto__:null,PROD_ID:"shopline",HTTP_COOKIE_KEY:ze,SESSION_ID_KEY:Je,UID_KEY:Ye,MERCHANT_ID_KEY:Ke,STORE_ID_KEY:We,COOKIE_SESSION_KEY:"n_sess",TRACKER_OPTIONS:$e,APP_ID:"101",PROJECT_ID:Xe,ACT:Ze,LEGACY_ACT:Qe,PLUGIN_ACT:et,DEFAULT_CODE:tt,REPORT_ENV:nt,LANDING_SIGN:rt,OUTSIDE_PROPERTIES:ot,MILLISECONDS_PER_MINUTE:it,MILLISECONDS_PER_DAY:at,NEED_GREY:ut,HTTP_COOKIE_KEY_BAK:dt,SESSION_ID_KEY_BAK:pt,GREY_STORAGE_TYPE:lt,USE_COOKIE_STORAGE:ft,STORE_UTILS:ht,NEW_STAT_ID_KEY:gt}),yt=-1,_t=function(e){addEventListener("pageshow",(function(t){t.persisted&&(yt=t.timeStamp,e(t))}),!0)},wt=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},bt=function(){var e=wt();return e&&e.activationStart||0},St=function(e,t){var n=wt(),r="navigate";return yt>=0?r="back-forward-cache":n&&(r=document.prerendering||bt()>0?"prerender":document.wasDiscarded?"restore":n.type.replace(/_/g,"-")),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:r}},kt=function(e,t,n){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var r=new PerformanceObserver((function(e){Promise.resolve().then((function(){t(e.getEntries())}))}));return r.observe(Object.assign({type:e,buffered:!0},n||{})),r}}catch(e){}},Tt=function(e,t){var n=function n(r){"pagehide"!==r.type&&"hidden"!==document.visibilityState||(e(r),t&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0)},Ot=function(e,t,n,r){var o,i;return function(a){t.value>=0&&(a||r)&&((i=t.value-(o||0))||void 0===o)&&(o=t.value,t.delta=i,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,n),e(t))}},Lt=function(e){requestAnimationFrame((function(){return requestAnimationFrame((function(){return e()}))}))},It=function(e){document.prerendering?addEventListener("prerenderingchange",(function(){return e()}),!0):e()},xt=-1,Et=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},Rt=function(e){"hidden"===document.visibilityState&&xt>-1&&(xt="visibilitychange"===e.type?e.timeStamp:0,Dt())},Pt=function(){addEventListener("visibilitychange",Rt,!0),addEventListener("prerenderingchange",Rt,!0)},Dt=function(){removeEventListener("visibilitychange",Rt,!0),removeEventListener("prerenderingchange",Rt,!0)},At=function(){return xt<0&&(xt=Et(),Pt(),_t((function(){setTimeout((function(){xt=Et(),Pt()}),0)}))),{get firstHiddenTime(){return xt}}},Ct=function(e,t){t=t||{},It((function(){var n,r=[1800,3e3],o=At(),i=St("FCP"),a=kt("paint",(function(e){e.forEach((function(e){"first-contentful-paint"===e.name&&(a.disconnect(),e.startTime<o.firstHiddenTime&&(i.value=Math.max(e.startTime-bt(),0),i.entries.push(e),n(!0)))}))}));a&&(n=Ot(e,i,r,t.reportAllChanges),_t((function(o){i=St("FCP"),n=Ot(e,i,r,t.reportAllChanges),Lt((function(){i.value=performance.now()-o.timeStamp,n(!0)}))})))}))},Nt=function(e,t){t=t||{},It((function(){var n,r=[.1,.25],o=St("CLS"),i=-1,a=0,s=[],c=function(t){i>-1&&e(t)},u=function(e){e.forEach((function(e){if(!e.hadRecentInput){var t=s[0],r=s[s.length-1];a&&e.startTime-r.startTime<1e3&&e.startTime-t.startTime<5e3?(a+=e.value,s.push(e)):(a=e.value,s=[e]),a>o.value&&(o.value=a,o.entries=s,n())}}))},d=kt("layout-shift",u);d&&(n=Ot(c,o,r,t.reportAllChanges),Ct((function(e){i=e.value,o.value<0&&(o.value=0,n())})),Tt((function(){u(d.takeRecords()),n(!0)})),_t((function(){a=0,i=-1,o=St("CLS",0),n=Ot(c,o,r,t.reportAllChanges),Lt((function(){return n()}))})))}))},Mt={passive:!0,capture:!0},jt=new Date,Ut=function(e,t){Re||(Re=t,Pe=e,De=new Date,Ft(removeEventListener),Ht())},Ht=function(){if(Pe>=0&&Pe<De-jt){var e={entryType:"first-input",name:Re.type,target:Re.target,cancelable:Re.cancelable,startTime:Re.timeStamp,processingStart:Re.timeStamp+Pe};Ae.forEach((function(t){t(e)})),Ae=[]}},Vt=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){Ut(e,t),o()},r=function(){o()},o=function(){removeEventListener("pointerup",n,Mt),removeEventListener("pointercancel",r,Mt)};addEventListener("pointerup",n,Mt),addEventListener("pointercancel",r,Mt)}(t,e):Ut(t,e)}},Ft=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,Vt,Mt)}))},Bt=function(e,t){t=t||{},It((function(){var n,r=[100,300],o=At(),i=St("FID"),a=function(e){e.startTime<o.firstHiddenTime&&(i.value=e.processingStart-e.startTime,i.entries.push(e),n(!0))},s=function(e){e.forEach(a)},c=kt("first-input",s);n=Ot(e,i,r,t.reportAllChanges),c&&Tt((function(){s(c.takeRecords()),c.disconnect()}),!0),c&&_t((function(){var o;i=St("FID"),n=Ot(e,i,r,t.reportAllChanges),Ae=[],Pe=-1,Re=null,Ft(addEventListener),o=a,Ae.push(o),Ht()}))}))},qt=0,Gt=1/0,zt=0,Jt=function(e){e.forEach((function(e){e.interactionId&&(Gt=Math.min(Gt,e.interactionId),zt=Math.max(zt,e.interactionId),qt=zt?(zt-Gt)/7+1:0)}))},Yt=function(){return Ce?qt:performance.interactionCount||0},Kt=function(){"interactionCount"in performance||Ce||(Ce=kt("event",Jt,{type:"event",buffered:!0,durationThreshold:0}))},Wt=0,$t=function(){return Yt()-Wt},Xt=[],Zt={},Qt=function(e){var t=Xt[Xt.length-1],n=Zt[e.interactionId];if(n||Xt.length<10||e.duration>t.latency){if(n)n.entries.push(e),n.latency=Math.max(n.latency,e.duration);else{var r={id:e.interactionId,latency:e.duration,entries:[e]};Zt[r.id]=r,Xt.push(r)}Xt.sort((function(e,t){return t.latency-e.latency})),Xt.splice(10).forEach((function(e){delete Zt[e.id]}))}},en=function(e,t){t=t||{},It((function(){var n=[200,500];Kt();var r,o=St("INP"),i=function(e){e.forEach((function(e){e.interactionId&&Qt(e),"first-input"===e.entryType&&!Xt.some((function(t){return t.entries.some((function(t){return e.duration===t.duration&&e.startTime===t.startTime}))}))&&Qt(e)}));var t,n=(t=Math.min(Xt.length-1,Math.floor($t()/50)),Xt[t]);n&&n.latency!==o.value&&(o.value=n.latency,o.entries=n.entries,r())},a=kt("event",i,{durationThreshold:t.durationThreshold||40});r=Ot(e,o,n,t.reportAllChanges),a&&(a.observe({type:"first-input",buffered:!0}),Tt((function(){i(a.takeRecords()),o.value<0&&$t()>0&&(o.value=0,o.entries=[]),r(!0)})),_t((function(){Xt=[],Wt=Yt(),o=St("INP"),r=Ot(e,o,n,t.reportAllChanges)})))}))},tn={},nn=function(e,t){t=t||{},It((function(){var n,r=[2500,4e3],o=At(),i=St("LCP"),a=function(e){var t=e[e.length-1];if(t){var r=Math.max(t.startTime-bt(),0);r<o.firstHiddenTime&&(i.value=r,i.entries=[t],n())}},s=kt("largest-contentful-paint",a);if(s){n=Ot(e,i,r,t.reportAllChanges);var c=function(){tn[i.id]||(a(s.takeRecords()),s.disconnect(),tn[i.id]=!0,n(!0))};["keydown","click"].forEach((function(e){addEventListener(e,c,{once:!0,capture:!0})})),Tt(c,!0),_t((function(o){i=St("LCP"),n=Ot(e,i,r,t.reportAllChanges),Lt((function(){i.value=performance.now()-o.timeStamp,tn[i.id]=!0,n(!0)}))}))}}))},rn=function e(t){document.prerendering?It((function(){return e(t)})):"complete"!==document.readyState?addEventListener("load",(function(){return e(t)}),!0):setTimeout(t,0)},on=function(e,t){t=t||{};var n=[800,1800],r=St("TTFB"),o=Ot(e,r,n,t.reportAllChanges);rn((function(){var i=wt();if(i){var a=i.responseStart;if(a<=0||a>performance.now())return;r.value=Math.max(a-bt(),0),r.entries=[i],o(!0),_t((function(){r=St("TTFB",0),(o=Ot(e,r,n,t.reportAllChanges))(!0)}))}}))},an=new(function(){function e(){this.cacheSessionItem=null,this.webVitals={CLS:"",FCP:"",FID:"",INP:"",LCP:"",TTFB:""},this.getWebVitals(),this.setCacheSessionItem=this.setCacheSessionItem.bind(this),this.getSessionId=this.getSessionId.bind(this)}return e.prototype.setCacheSessionItem=function(e){this.cacheSessionItem=e},e.prototype.getHttpCookie=function(e){void 0===e&&(e=0);var t=Ge.get(ze);return t||(t=h(),Ge.set(ze,t,e)),ut&&Ge.set(dt,t,e),t},e.prototype.getSessionId=function(e,t,n){void 0===e&&(e=30),void 0===t&&(t=0);var r=ht.getRaw(Je),o=+new Date;n&&(o-=n);var i=r.value;i||(this.cacheSessionItem?(i=(r=this.cacheSessionItem).value,Oe("getSessionId::use cacheSessionItem: ".concat(JSON.stringify(r)))):i={});var a=i.sid||"",s=r.maxAge&&r.maxAge<o,c=+i.ite;if(!i.sid||s){i={sid:h(),createAt:o,rn:1,last_session_id:a,session_create_type:101};var u=document.referrer;if(u){var d=window.location.host;new URL(u).host!==d&&(i.ref=u)}s&&(i.session_create_type=c?103:102)}var p=new Date(o).setUTCHours(0,0,0,0);p<o&&(p+=at);var l=(p-o)/it,f=o+new Date(o).getTimezoneOffset()*it+1e3*t,v=(new Date(f+at).setHours(0,0,0,0)-f)/it,g=Math.min(e,l,v);return i.ite=l<e||v<e?1:0,o+e*it<i.createAt&&(i.createAt=o),ht.set(Je,i,g,n,{callback:this.setCacheSessionItem}),ut&&ht.set(pt,i,g,n),ft&&Ge.set(Je,i,g,n,{callback:this.setCacheSessionItem}),i},e.prototype.getSession=function(){return ht.getRaw(Je)},e.prototype.getRawSessionId=function(){var e,t;return(null===(t=null===(e=this.getSession())||void 0===e?void 0:e.value)||void 0===t?void 0:t.sid)||""},e.prototype.upsetSessionRn=function(e){var t=e.rn||1,n=t+1;return ht.append(Je,{rn:n},this.setCacheSessionItem),ht.append(pt,{rn:n}),ft&&Ge.append(Je,{rn:n},this.setCacheSessionItem),t},e.prototype.getHttpSearch=function(){return window.location.search},e.prototype.getUrlPath=function(){return window.location.pathname},e.prototype.getMobile=function(){var e=navigator.userAgent,t=!e.match(/(iPad).*OS\s([\d_]+)/)&&e.match(/(iPhone\sOS)\s([\d_]+)/),n=e.match(/(Android)\s+([\d.]+)/);return t||n},e.prototype.getIsMobile=function(){return this.getMobile()?"101":"102"},e.prototype.getWebsite=function(){return this.getMobile()?"102":"101"},e.prototype.getLanguage=function(){return navigator.language},e.prototype.getUserId=function(){return Me.get(Ye)},e.prototype.getMerchantId=function(){var e;return Me.get(Ke)||(null===(e=window.Shopline)||void 0===e?void 0:e.merchantId)},e.prototype.getTitle=function(){var e;return null===(e=document.title)||void 0===e?void 0:e.substr(0,255)},e.prototype.getStoreId=function(){var e;return Me.get(We)||(null===(e=window.Shopline)||void 0===e?void 0:e.storeId)},e.prototype.getScreenWidth=function(){return window.screen.width},e.prototype.getScreenHeight=function(){return window.screen.height},e.prototype.getWebVitals=function(){var e=this;[nn,Bt,Nt,en,Ct,on].forEach((function(t){return t((function(t){e.webVitals[t.name]=t.value}))}))},e.prototype.getPerformance=function(){var e=window.performance||window.webkitPerformance,t={},n=e&&e.timing;if(e&&n){var r=0;if(window.chrome&&"function"==typeof window.chrome.loadTimes){var o=window.chrome.loadTimes();o&&(r=1e3*o.firstPaintTime,r-=n.navigationStart)}t.dns=Math.ceil(n.domainLookupEnd-n.domainLookupStart),t.tcp=Math.ceil(n.connectEnd-n.connectStart),t.request=Math.ceil(n.responseEnd-n.requestStart),t.connect=Math.ceil(n.responseStart-n.domainLookupStart),t.processing=Math.ceil((n.domComplete||n.domLoading)-n.domLoading),t.ready=Math.ceil(n.domContentLoadedEventEnd-n.navigationStart),t.load=Math.ceil(n.loadEventEnd-n.navigationStart),t.white=Math.ceil(n.responseStart-n.navigationStart),t.first_paint=r,t.first_paint||(t.first_paint=n.domLoading>=n.navigationStart?n.domLoading-n.navigationStart:0),t.first_paint=Math.ceil(t.first_paint),t.active=Math.ceil(n.domInteractive-n.navigationStart)}return t},e}()),sn="1.7.14",cn=new(function(){function e(){this.statData=null}return e.prototype.getStatData=function(e){var t,n=(Ge.getRaw(gt)||{}).value;n||this.statData&&(n=this.statData);var r=+new Date;if(!n||n.createUTCTime+at<r){var o=new Date(r).setUTCHours(0,0,0,0);n={statId:h(),lastStatId:null==n?void 0:n.statId,statRn:0,eventRnMap:{},createUTCTime:o}}if(e){var i=null!==(t=n.eventRnMap[e])&&void 0!==t?t:0;n.eventRnMap[e]=i+1}return n.statRn+=1,Ge.set(gt,n),this.statData=n,n},e.prototype.addNewStatInfoToPayload=function(e){try{var t="eventName"in e&&"string"==typeof e.eventName?e.eventName:"",n=this.getStatData(t);return o(o({},e),{stat_id:n.statId,stat_rn:n.statRn,event_rn:t?n.eventRnMap[t]:void 0})}catch(t){return e}},e}()),un=function(e,t){Oe("".concat(e,"_deprecated"),t)},dn=function(){function e(){var e,n;this.debugMode=!0,this.options=o(o({},$e),{timezoneOffset:0,env:"",disableIframeId:!1,mergeTransformer:function(e){return e.reduce((function(e,t){if(5800===Number(t.event_id)){var n=e.find((function(e){return 5900===Number(e.event_id)}));n?n.moreinfo.list.push(t.moreinfo):e.push(o(o({},t),{event_id:5900,moreinfo:{list:[t.moreinfo]}}))}else e.push(t);return e}),[])},addStatInfoToMoreinfo:function(e){try{if(5800===Number(null==e?void 0:e.event_id)){var n=e.moreinfo;return"object"===t(n)&&null!==n&&"eventTracker"in n&&"Subscribed"===n.eventTracker?o(o({},e),{moreinfo:cn.addNewStatInfoToPayload(n)}):e}return e}catch(t){return e}}}),this.interceptor={},this.hdsdkFilterEvents=null===(n=null===(e=window.__ENV__)||void 0===e?void 0:e.ANALYTICS_UNIFY_CONFIG)||void 0===n?void 0:n.hdsdkFilterEvents}return e.prototype.validateParams=function(e){var n=this.hdsdkFilterEvents;if(!n||!n.enable||!n.events)return!0;var r=n.events[e.act||""];if(!(null==r?void 0:r.length))return!0;for(var o=function(t){var n=r[t],o=Object.keys(n);if(o.length&&o.every((function(t){var r=n[t],o=e[t];return"number"==typeof r?Number(r)===Number(o):r===o})))return{value:!1}},i=0;i<r.length;i++){var a=o(i);if("object"===t(a))return a.value}return!0},e.prototype.setOptions=function(e){this.options=o(o({},this.options),e),-1!==nt.indexOf(this.options.env)&&this.setDebugMode(!1)},e.prototype.getOptions=function(){return this.options},e.prototype.setDebugMode=function(e){this.debugMode=e},e.prototype.initInstance=function(e){void 0===e&&(e={});var t=Se;return t&&t.default&&(t=t.default),t(o(o(o({},this.options),e),{domain:"".concat(window.location.host,"/eclytics")}))},e.prototype.use=function(e,t){switch(e){case"url":case"request":this.interceptor[e]=t;break;default:this.instance?this._instanceUse(e,t):this.interceptor[e]=t}},e.prototype._instanceUse=function(e,t,n){void 0===n&&(n=this.instance),n&&(n.use(e,t),["httpInstance","beaconInstance"].forEach((function(r){var o;null===(o=n[r])||void 0===o||o.use(e,t)})))},e.prototype._interceptorUse=function(e){var t=this;void 0===e&&(e=this.instance),Object.keys(this.interceptor).filter((function(e){return!/(url|request)/.test(e)})).forEach((function(n){"function"==typeof t.interceptor[n]&&t._instanceUse(n,t.interceptor[n],e)}))},e.prototype._useRequestCallback=function(e){var t,n=this.options,r=n.timeOffset,i=n.formatParamsBeforeSend;if(r){if(e.__fromPlugin__){var a=e,s=a.moreinfo,c=a.event_info,u=a.request_time,d=c.event_created_at_ms;return e.event_info.event_created_at_ms=d-r,e.event_info.event_sent_at_ms=u-r,e.moreinfo=JSON.stringify(s),e.event_info=JSON.stringify(c),delete e.__fromPlugin__,delete e.request_time,delete e.time,delete e.domain,e}var p=e.event_created_at_ms,l=e.request_time,f=null===(t=e.moreinfo)||void 0===t?void 0:t.event_created_at_ms;f&&(e.moreinfo.event_created_at_ms=String(f-r)),e.event_created_at_ms=p?p-r:void 0,e.request_time=l-r,e.time=Math.ceil(e.request_time/1e3)}if(e.act===Qe)return e;var v=o(o({},e),{event_sent_at_ms:e.request_time});return delete v.request_time,v.$data_id&&(v.data_id=v.$data_id,delete v.$data_id),"function"==typeof i?i(v):v},e.prototype.getInstance=function(){var e=this;if(!this.instance){this.instance=this.initInstance();var t=h();this._instanceUse("url",(function(n,r,o){"function"==typeof e.interceptor.url&&(n=e.interceptor.url(n,r,o));var i=an.getSession().value;if(i&&i.sid){var a=i.sid,s=i.createAt,c=[].concat(r),u=function(e){var t=0;return(e=[].concat(e))&&e.length&&(t=e.some((function(e){var t,n,r,o;return"101"===String(null===(n=null===(t=e.source)||void 0===t?void 0:t.moreinfo)||void 0===n?void 0:n.event_name)&&"60006253"===String(null===(r=e.source)||void 0===r?void 0:r.eventid)||"PageView"===(null===(o=e.source)||void 0===o?void 0:o.event_name)}))),Number(t)}(c);return"".concat(n).concat(-1===n.indexOf("?")?"?":"&","_sid=").concat(a,"&_sct=").concat(s,"&_tid=").concat(t,"&_pdppv=").concat(u,"&_bcount=").concat(c.length)}return n})),this._instanceUse("request",this._useRequestCallback.bind(this)),this._interceptorUse()}return this.instance},e.prototype.getServerInstance=function(){return un("getServerInstance"),this.getInstance()},e.prototype.reportV2=function(e,t){return a(this,void 0,void 0,(function(){var n,r,a,c,u,d,p,l,f,v,h,g,m,y,_,w,b,S,k,T,O,L,I,x,E,R,P,D,A,C,N,M,j,U,H,V,F,B,q,G,z;return s(this,(function(s){return r=(n=t||{}).immediately,a=n.isHttpReport,c=n.reportNow,u=n.ignoreLanding,d=void 0!==u&&u,p=n.actFields,l=e.app_id,f=e.http_cookie,v=e.session_id,h=e.session_create_time,g=e.session_rn,m=e.last_session_id,y=e.session_create_type,_=e.store_id,w=e.action_type,b=void 0===w?tt:w,S=e.module,k=void 0===S?tt:S,T=e.page,O=void 0===T?tt:T,L=e.component,I=void 0===L?tt:L,x=e.store_timezone,E=e.user_timezone,R=e.store_region,P=e.event_created_at_ms,D=e.device_token,A=e.ua_info,C=e.event_id,N=e.event_name,M=e.data_id,j=e.moreinfo,U=void 0===j?{}:j,H=i(e,["app_id","http_cookie","session_id","session_create_time","session_rn","last_session_id","session_create_type","store_id","action_type","module","page","component","store_timezone","user_timezone","store_region","event_created_at_ms","device_token","ua_info","event_id","event_name","data_id","moreinfo"]),V=ke(H,ot),F=ke(U,ot),B=d?0:this._getSessionCreateDataId({sid:v,isCollect:!0}),q=o(o(o(o({project_id:Xe,app_id:l,act:Ze,http_cookie:f,session_id:v,session_create_time:h,session_rn:g,last_session_id:m,session_create_type:y,store_id:_,action_type:b,module:k,page:O,component:I,store_timezone:x,user_timezone:E,store_region:R,event_created_at_ms:P,event_id:C,event_name:N,device_token:D,ua_info:A,env:this.options.env},F),V),p),{moreinfo:o(o(o({},U),H),{session_create_data_id:B})}),(G=this._formatReportParams(q)).is_server=0,this.debugMode&&(console.groupCollapsed("Tracker Debug(reportV2):Wait Mode:".concat(this.options.wait,".event_id:").concat(C," immediately:").concat(!!r," isHttpReport:").concat(!!a," reportNow:").concat(!!c)),console.table(e),console.groupEnd()),-1===nt.indexOf(this.options.env)?[2,Promise.resolve()]:(M&&(G.$data_id=M),z=this.getInstance(),[2,this._instanceReport(z,G,t)])}))}))},e.prototype._pluginReport=function(t,n){return a(this,void 0,void 0,(function(){var r,a,c,u,d,p,l,f,v,h,g,m,y,_;return s(this,(function(s){switch(s.label){case 0:return r=this.getOptions(),a=r.env,c=r.beforeSend,-1===nt.indexOf(a)?[2,Promise.resolve()]:(u=t.app_id,d=t.event_id,p=t.event_name,l=t.event_ext_info,f=i(t,["app_id","event_id","event_name","event_ext_info"]),v={},c&&"function"==typeof c?[4,c(v)]:[3,2]);case 1:v=s.sent(),s.label=2;case 2:return h=an.getSession().value,g=o({screen_height:an.getScreenHeight(),screen_width:an.getScreenWidth(),store_timezone:v.store_timezone,user_id:an.getUserId(),user_timezone:v.user_timezone},f),m={event_created_at_ms:+new Date,event_id:d,event_name:p},l&&(m.event_ext_info=e.encodeParams(l)),y={app_id:u,act:et,env:a,http_cookie:an.getHttpCookie(),merchant_id:an.getMerchantId(),moreinfo:g,event_info:m,store_id:an.getStoreId(),uuid:v.iframe_id,version:sn,session_id:(null==h?void 0:h.sid)||"",session_create_time:(null==h?void 0:h.createAt)||"",session_create_type:(null==h?void 0:h.session_create_type)||"",last_session_id:(null==h?void 0:h.last_session_id)||"",__fromPlugin__:1},_=this.getInstance(),[2,this._instanceReport(_,y,n)]}}))}))},e.prototype._instanceReport=function(e,t,n){var r=n||{},o=r.isHttpReport,i=r.reportNow,a=r.immediately,s=o?null==e?void 0:e.httpInstance.report(t,i):null==e?void 0:e.report(t,i);return a&&e.post(),s},e.prototype._formatReportParams=function(t){var n=e.encodeParams(t),r=t.moreinfo||{};return n.moreinfo=JSON.stringify(r),n},e.prototype.reportJudge=function(){return un("reportJudge"),Promise.resolve()},e.prototype.getDataId=function(){return h()},e.prototype.setServerRn=function(){un("setServerRn")},e.prototype._getSessionCreateDataId=function(e){var t,n,r=e.sid,o=e.isCollect,i=void 0!==o&&o,a=Ge.get(rt),s=(null==a?void 0:a[r])||[];if(!s||!Array.isArray(s))return 0;var c=s[0],u=s[1];return i&&!u?(Ge.set(rt,((t={})[r]=[c,1],t)),1):i||c?0:(Ge.set(rt,((n={})[r]=[1,u],n)),1)},e.encodeParams=function(e){return Object.keys(e).reduce((function(t,n){try{t[n]=encodeURIComponent(e[n]||"")}catch(r){console.error("[tracker] encodeURIComponent params error:",r),t[n]=e[n]}return t}),{})},e}(),pn=function(){function e(){this.groups={}}return e.prototype.add=function(e,t){(this.groups[e]||(this.groups[e]=new Set)).add(t)},e.prototype.entries=function(){return Object.entries(this.groups)},e.prototype.clear=function(){this.groups={}},e}(),ln=function(){function e(){this.nextTickId=null,this.onTick=function(){},this.intervalMs=10,this.looping=!1}return e.prototype.start=function(e,t){var n=this;this.stop(),this.onTick=e,this.intervalMs=Math.max(10,t),this.looping=!0;a(n,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.nextTick(this.intervalMs)];case 1:return e.sent(),this.onTick(),[3,0];case 2:return[2]}}))}))},e.prototype.tick=function(){this.onTick(),this.looping&&this.start(this.onTick,this.intervalMs)},e.prototype.stop=function(){this.nextTickId&&window.clearTimeout(this.nextTickId),this.looping=!1},e.prototype.nextTick=function(e){return a(this,void 0,void 0,(function(){var t=this;return s(this,(function(n){return[2,new Promise((function(n){t.nextTickId=window.setTimeout(n,e)}))]}))}))},e}();!function(e){e[e.Uninit=0]="Uninit",e[e.Inited=1]="Inited"}(Ne||(Ne={}));var fn=function(){function e(e,t){void 0===t&&(t={}),this.htmlElementGroups=new pn,this.asyncLoop=new ln,this.exposedElements=new Set,this.collect=null,this.state=Ne.Uninit,this.effectRemovalSet=new Set,(null===window||void 0===window?void 0:window.SL_Report)||(window.SL_Report={}),window.SL_Report.exposeMap||(window.SL_Report.exposeMap=new Map,this.effectRemovalSet.add((function(){window.SL_Report.exposeMap&&(window.SL_Report.exposeMap.clear(),delete window.SL_Report.exposeMap)}))),this.collect=e,this.options=t}return e.prototype.init=function(){this.initExposeObserver(),this.initExposeAsyncLoop(),this.state=Ne.Inited},e.prototype.initExposeObserver=function(){var e=this,t={threshold:Array.from(Array(11).keys()).map((function(e){return e/10})),root:null,rootMargin:"0px"};window.SL_Report.exposeObserver=new IntersectionObserver((function(t){t.forEach((function(t){var n,r,o=t.isIntersecting,i=t.intersectionRatio,a=t.boundingClientRect,s=t.time,c=t.target,u=c.dataset.__trackerSelector||"",d=(null===(n=window.SL_Report.exposeMap)||void 0===n?void 0:n.get(u))||{},p=d.view,l=d.viewSuccess,f=(l||{}).threshold,v=void 0===f?.5:f,h=a.height>window.innerHeight;h&&(c.dataset.__trackerSuperLong="1"),o&&l&&(i>=v||h)?c.dataset.__trackerViewSucceed||c.dataset.__trackerViewSuccessOnce||(c.dataset.__trackerLastViewStarted=String(s),c.dataset.__trackerViewSucceed="1",e.exposedElements.add(c),(null===(r=window.SL_Report)||void 0===r?void 0:r.exposeTimer)||e.checkTimer({element:c})):(e.resetTime(c),delete c.dataset.__trackerViewSucceed,e.exposedElements.delete(c)),o&&p&&i>=0?c.dataset.__trackerViewed||c.dataset.__trackerViewOnce||(e.reportView(c,p),c.dataset.__trackerViewed="1",p.reportOnce&&(c.dataset.__trackerViewOnce="1")):delete c.dataset.__trackerViewed}))}),t),this.effectRemovalSet.add((function(){window.SL_Report.exposeObserver&&(window.SL_Report.exposeObserver.disconnect(),delete window.SL_Report.exposeObserver)})),this.effectRemovalSet.add((function(){window.SL_Report.exposeTimer&&(clearTimeout(window.SL_Report.exposeTimer),delete window.SL_Report.exposeTimer)}))},e.prototype.initExposeAsyncLoop=function(){var e=this;this.asyncLoop.start((function(){var t=window.SL_Report.exposeMap;if(t){for(var n=0,r=e.htmlElementGroups.entries();n<r.length;n++){var o=r[n],i=o[0],a=o[1],s=t.get(i);if(s&&s.viewSuccess&&s.viewSuccess.batch&&a.size>0)try{e.reportViewSuccess(Array.from(a),s.viewSuccess)}catch(e){}}e.htmlElementGroups.clear()}}),this.options.asyncLoopInterval||5e3);var t=function(){"hidden"===document.visibilityState&&e.asyncLoop.tick()};document.addEventListener("visibilitychange",t);var n=function(){e.asyncLoop.tick()};window.addEventListener("pagehide",n),this.effectRemovalSet.add((function(){return e.asyncLoop.stop()})),this.effectRemovalSet.add((function(){return document.removeEventListener("visibilitychange",t)})),this.effectRemovalSet.add((function(){return window.removeEventListener("pagehide",n)}))},e.prototype.reportView=function(e,t){var n,r=(t||{}).params,i=void 0===r?{}:r;"function"==typeof i&&(i=i(e)),null===(n=this.collect)||void 0===n||n.call(this,o({event_name:"View",action_type:101},i))},e.prototype.reportViewSuccess=function(e,t){var n,r=(t||{}).params,i=void 0===r?{}:r;"function"==typeof t.params&&(t.batch&&Array.isArray(e)?i=t.params(e):t.batch||Array.isArray(e)||(i=t.params(e))),null===(n=this.collect)||void 0===n||n.call(this,o({event_name:"ViewSuccess",action_type:108},i),{reportNow:t.batch})},e.prototype.track=function(e){var t=this,n=e.selector,r=e.targetList;if(n||(null==r?void 0:r.length)){this.state===Ne.Uninit&&this.init();var o=Math.random().toString(32).slice(2),i=r?'[data-__tracker-id="'.concat(o,'"]'):n,a=window.SL_Report,s=a.exposeObserver,c=a.exposeMap;this.checkTimer({options:e}),(r||document.querySelectorAll(n)).forEach((function(e){t.resetTime(e),e.dataset.__trackerSelector=i||n,(null==r?void 0:r.length)&&(e.dataset.__trackerId=o),s.observe(e)})),c.set(i,e)}},e.prototype.dispose=function(){this.effectRemovalSet.forEach((function(e){return e()}))},e.prototype.checkTimer=function(e){var t,n=this,r=e.element,o=e.options;if(window.SL_Report.exposeMap){var i=o;if(!i){var a=(null==r?void 0:r.dataset.__trackerSelector)||"";i=window.SL_Report.exposeMap.get(a)}var s=this.getTimeout(i);clearTimeout(null===(t=window.SL_Report)||void 0===t?void 0:t.exposeTimer);var c=function(){window.SL_Report.exposeTimer=window.setTimeout((function(){!n.handleRefreshTimeout()&&c()}),s)};c()}},e.prototype.handleRefreshTimeout=function(){var e=this;if(!this.exposedElements.size)return clearTimeout(window.SL_Report.exposeTimer),delete window.SL_Report.exposeTimer,!0;var t=window.SL_Report,n=t.exposeMap,r=t.exposeObserver;n&&this.exposedElements.forEach((function(t){var o=t.dataset,i=o.__trackerTotalViewTime,a=void 0===i?0:i,s=o.__trackerSelector,c=void 0===s?"":s,u=o.__trackerSuperLong,d=document.querySelectorAll(c);if(!Array.from(d).some((function(e){return e===t})))return e.exposedElements.delete(t),void r.unobserve(t);var p=(n.get(c)||{}).viewSuccess,l=void 0===p?{}:p,f=l.threshold,v=void 0===f?.5:f;if(u){var h=t.getBoundingClientRect(),g=h.top,m=h.height;if(g+m<0)return e.resetTime(t);if((window.innerHeight-g)/m<v)return e.resetTime(t)}e.updateExposeTimer(t),+a>=(l.duration||300)&&(l.batch?e.htmlElementGroups.add(c,t):e.reportViewSuccess(t,l),e.resetTime(t),e.exposedElements.delete(t),l.reportOnce&&(t.dataset.__trackerViewSuccessOnce="1"))}))},e.prototype.updateExposeTimer=function(e){var t=+(e.dataset.__trackerLastViewStarted||0),n=performance.now();if(t){var r=n-t;e.dataset.__trackerTotalViewTime=String(parseFloat(e.dataset.__trackerTotalViewTime)+r)}e.dataset.__trackerLastViewStarted=String(n)},e.prototype.getTimeout=function(e){var t,n=window.SL_Report.exposeMap;if(!n)return 1e3;var r=Array.from(n.values()).map((function(e){var t;return((null===(t=e.viewSuccess)||void 0===t?void 0:t.duration)||300)/2})),o=Math.min.apply(Math,c(c([],r,!1),[1e3,((null===(t=null==e?void 0:e.viewSuccess)||void 0===t?void 0:t.duration)||300)/2],!1));return o>100?o:100},e.prototype.resetTime=function(e){e.dataset.__trackerTotalViewTime="0",e.dataset.__trackerLastViewStarted="0"},e}();var vn=function(e){var n=t(e);return null!=e&&("object"==n||"function"==n)},hn="object"==t(j)&&j&&j.Object===Object&&j,gn="object"==("undefined"==typeof self?"undefined":t(self))&&self&&self.Object===Object&&self,mn=hn||gn||Function("return this")(),yn=function(){return mn.Date.now()},_n=/\s/;var wn=function(e){for(var t=e.length;t--&&_n.test(e.charAt(t)););return t},bn=/^\s+/;var Sn=function(e){return e?e.slice(0,wn(e)+1).replace(bn,""):e},kn=mn.Symbol,Tn=Object.prototype,On=Tn.hasOwnProperty,Ln=Tn.toString,In=kn?kn.toStringTag:void 0;var xn=function(e){var t=On.call(e,In),n=e[In];try{e[In]=void 0;var r=!0}catch(e){}var o=Ln.call(e);return r&&(t?e[In]=n:delete e[In]),o},En=Object.prototype.toString;var Rn=function(e){return En.call(e)},Pn=kn?kn.toStringTag:void 0;var Dn=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Pn&&Pn in Object(e)?xn(e):Rn(e)};var An=function(e){return null!=e&&"object"==t(e)};var Cn=function(e){return"symbol"==t(e)||An(e)&&"[object Symbol]"==Dn(e)},Nn=/^[-+]0x[0-9a-f]+$/i,Mn=/^0b[01]+$/i,jn=/^0o[0-7]+$/i,Un=parseInt;var Hn=function(e){if("number"==typeof e)return e;if(Cn(e))return NaN;if(vn(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=vn(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Sn(e);var n=Mn.test(e);return n||jn.test(e)?Un(e.slice(2),n?2:8):Nn.test(e)?NaN:+e},Vn=Math.max,Fn=Math.min;var Bn=function(e,t,n){var r,o,i,a,s,c,u=0,d=!1,p=!1,l=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var n=r,i=o;return r=o=void 0,u=t,a=e.apply(i,n)}function v(e){return u=e,s=setTimeout(g,t),d?f(e):a}function h(e){var n=e-c;return void 0===c||n>=t||n<0||p&&e-u>=i}function g(){var e=yn();if(h(e))return m(e);s=setTimeout(g,function(e){var n=t-(e-c);return p?Fn(n,i-(e-u)):n}(e))}function m(e){return s=void 0,l&&r?f(e):(r=o=void 0,a)}function y(){var e=yn(),n=h(e);if(r=arguments,o=this,c=e,n){if(void 0===s)return v(c);if(p)return clearTimeout(s),s=setTimeout(g,t),f(c)}return void 0===s&&(s=setTimeout(g,t)),a}return t=Hn(t)||0,vn(n)&&(d=!!n.leading,i=(p="maxWait"in n)?Vn(Hn(n.maxWait)||0,t):i,l="trailing"in n?!!n.trailing:l),y.cancel=function(){void 0!==s&&clearTimeout(s),u=0,r=c=o=s=void 0},y.flush=function(){return void 0===s?a:m(yn())},y};var qn=function(e,t,n){var r=!0,o=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return vn(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),Bn(e,t,{leading:r,maxWait:t,trailing:o})},Gn=function(){function e(e){var t=this;this.totalDuration=0,this.currPeriodDuration=0,this.currPeriodStart=0,this.isPageleft=!1,this.opts=e,this.report=function(n,r){return a(t,void 0,void 0,(function(){var t;return s(this,(function(o){switch(o.label){case 0:if(this.isPageleft)return[2];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,e.report(n,r)];case 2:return o.sent(),[3,4];case 3:return t=o.sent(),Oe("[PageHideTracker] Failed to report. data: ".concat(JSON.stringify(n)),m(t)),[3,4];case 4:return[2]}}))}))}}return e.prototype.updateDuration=function(){var e=this.currPeriodStart,t=(Date.now()-e)/1e3;(Number.isNaN(t)||t<0)&&(t=0),t=Number(t.toFixed(3)),t=Math.min(t,1800),this.currPeriodDuration=t,this.totalDuration+=t},e.prototype.getInternalReportData=function(e){this.updateDuration();var t=e.trigger_by,n=i(e,["trigger_by"]),r=o(o({},n),{event_name:"PageDuration",event_duration:this.currPeriodDuration});if(this.opts.moreInfoDebugEnabled){var a={total_duration:this.totalDuration,trigger_by:t};r=o(o({},r),a)}return r},e.prototype.startNewPeriod=function(){this.isPageleft=!1,this.currPeriodStart=Date.now()},e.prototype.reportOnHide=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.report(this.getInternalReportData({trigger_by:"hide"}),{})];case 1:return e.sent(),[2]}}))}))},e.prototype.reportOnLeave=function(e,t){return a(this,void 0,void 0,(function(){var n;return s(this,(function(r){return n=this.report(o(o({},this.getInternalReportData(t)),e),{}),this.isPageleft=!0,[2,n]}))}))},e.prototype.reportOnSessionChange=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.report(this.getInternalReportData({trigger_by:"sessionChange"}),e)];case 1:return t.sent(),[2]}}))}))},e}();var zn,Jn,Yn=function(){function e(e){var t=this;this.asyncLoop=new ln,this.currPeriodDuration=0,this.currPeriodStart=0,this.isPageLeave=!1,this.pageDurationGroups=[],this.opts=e,this.addReportGroups=function(e){return a(t,void 0,void 0,(function(){return s(this,(function(t){return this.isPageLeave||this.pageDurationGroups.push(e),[2]}))}))},this.report=function(n){return a(t,void 0,void 0,(function(){var t;return s(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e.report(n)];case 1:return r.sent(),[3,3];case 2:return t=r.sent(),Oe("[PageHideTracker] Failed to report. data: ".concat(JSON.stringify(n)),m(t)),[3,3];case 3:return[2]}}))}))},this.initAsyncLoop()}return e.prototype.initAsyncLoop=function(){var e=this;this.asyncLoop.start((function(){var t=e.pageDurationGroups.length,n=e.pageDurationGroups[t-1];if(n){var r=e.pageDurationGroups.reduce((function(e,t){return e+t.event_duration}),0);r=Number(r.toFixed(3)),e.report(o(o({},n),{event_duration:r})),e.pageDurationGroups=[]}}),this.opts.asyncLoopInterval||3e3)},e.prototype.updateDuration=function(){var e=this.currPeriodStart,t=(Date.now()-e)/1e3;(Number.isNaN(t)||t<0)&&(t=0),t=Number(t.toFixed(3)),t=Math.min(t,1800),this.currPeriodDuration=t},e.prototype.getInternalReportData=function(){return this.updateDuration(),{event_name:"PageDurationWithPageLeave",event_duration:this.currPeriodDuration}},e.prototype.startNewPeriod=function(){this.isPageLeave=!1,this.currPeriodStart=Date.now()},e.prototype.reportOnHide=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.addReportGroups(this.getInternalReportData())];case 1:return e.sent(),[2]}}))}))},e.prototype.reportOnLeave=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return this.addReportGroups(o(o(o(o({},this.getInternalReportData()),e),t),{is_pageleave:1})),this.isPageLeave=!0,[4,this.asyncLoop.tick()];case 1:return n.sent(),[2,Promise.resolve()]}}))}))},e.prototype.reportOnSessionChange=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.addReportGroups(this.getInternalReportData())];case 1:return e.sent(),[2]}}))}))},e.prototype.dispose=function(){this.asyncLoop.stop()},e}();var Kn=ut&&(null===(Jn=null===(zn=window.__ENV__)||void 0===zn?void 0:zn.ANALYTICS_UNIFY_CONFIG)||void 0===Jn?void 0:Jn.greyLog);var Wn=new(function(e){function t(){var t,n,r,i,c=this;return(c=e.call(this)||this).maxScrollTop=0,c.skipOnSessionUpdate=!1,c.beginSessionId="",c.heartbeatIds=[],c.exposeInstance=null,c.destUrlLock=!1,c.pageLeaveLock=!1,c.pageDurationAndLeaveTracker=null,c.pageDurationTracker=function(e){var t,n,r,i;return new Gn(o(o({},e),{moreInfoDebugEnabled:!!(null===(r=null===(n=null===(t=window.__ENV__)||void 0===t?void 0:t.ANALYTICS_UNIFY_CONFIG)||void 0===n?void 0:n.pageHideGreyStoreIds)||void 0===r?void 0:r.includes(null===(i=window.Shopline)||void 0===i?void 0:i.storeId))}))}({report:function(e,t){return a(c,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:return n=this.beginSessionId||an.getRawSessionId(),r=this.getMaxHeightParams(),[4,this.collect(o(o(o({},r),e),{begin_session:n}),o(o({},t),{reportNow:!0}))];case 1:return i.sent(),[2]}}))}))}}),(null===(t=window.SL_Report)||void 0===t?void 0:t.isHitPageDurationGray)&&(c.pageDurationAndLeaveTracker=(i={report:function(e){return a(c,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return t=this.beginSessionId||an.getRawSessionId(),n=this.getMaxHeightParams(),[4,this.collect(o(o(o({},n),e),{begin_session:t}),{reportNow:!0})];case 1:return r.sent(),[2]}}))}))},asyncLoopInterval:null===(n=c.getOptions())||void 0===n?void 0:n.pageDurationAsyncLoopInterval},new Yn(o({},i)))),(null===(r=window.SL_Report)||void 0===r?void 0:r.skipSelfInit)||c.init(),c}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t.prototype.setMode=function(e){"debug"===e?this.setDebugMode(!0):this.setDebugMode(!1)},t.prototype.getBaseParams=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a,c,u,d,p,l,f,v,h,g,m;return s(this,(function(s){switch(s.label){case 0:return 1,t=this.getOptions(),n=t.timezoneOffset,r=void 0===n?0:n,o=t.handleBaseParams,i=t.disableIframeId,a=t.timeOffset,c=void 0===a?0:a,d=(u=e||{}).ignoreSession,p=void 0!==d&&d,l=u.ignoreSessionRn,f=void 0!==l&&l,v=u.session,h={version:sn,iframe_id:1,http_cookie:an.getHttpCookie(),url_path:an.getUrlPath(),language:an.getLanguage(),is_mobile:an.getIsMobile(),merchant_id:an.getMerchantId(),user_id:an.getUserId(),http_search:an.getHttpSearch(),title:an.getTitle(),store_id:an.getStoreId(),website:an.getWebsite(),loading_time:an.getPerformance().load,event_created_at_ms:+new Date,screen_width:an.getScreenWidth(),screen_height:an.getScreenHeight()},p||(g=(null==v?void 0:v.sid)?v:an.getSessionId(30,r,c),m=f?void 0:an.upsetSessionRn(g),h.session_id=g.sid,h.session_create_time=g.createAt,h.session_rn=m,h.last_session_id=g.last_session_id,h.session_create_type=g.session_create_type),i&&delete h.iframe_id,o&&"function"==typeof o?[4,o(h)]:[3,2];case 1:s.sent(),s.label=2;case 2:return[2,h]}}))}))},t.prototype.setDefaultEventId=function(e){var t=e.event_name,n=void 0===t?"":t,r=e.event_id,i=e.action_type;if(_.includes(n)){var a=tt,s=r||"",c=/^([a-zA-Z]+)(.*)$/.exec(s);if(s)if(c){var u=c[1],d=c[2];u&&d&&(s="".concat(function(e){var t;if(!(null===(t=null==e?void 0:e.trim)||void 0===t?void 0:t.call(e)))return e;var n="string"==typeof e?e:"".concat(e);return n.charAt(0).toUpperCase()+n.slice(1)}(u)).concat(Te(d)))}else s="".concat(n).concat(Te(s));else s="".concat(n,"_").concat(Date.now(),"_").concat(h().replace(/-/g,""));return w.includes(n)&&(a=i||a),o(o({},e),{action_type:a,event_id:s})}return e},t.prototype.collect=function(e,t){var n,r,i,c,u;return void 0===t&&(t={}),a(this,void 0,void 0,(function(){var a,d,p,l,f,v,h,g,_,w,b,S,k,T,O;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,7,,8]),navigator.userAgent.indexOf("SL2ShopperApp")>-1?[2,this.shopperAppReport(e)]:this.validateParams(o(o({act:Ze},e),null==t?void 0:t.actFields))?(a=this.getOptions(),d=a.beforeSend,p=a.onSessionUpdate,l=a.timezoneOffset,f=a.timeOffset,v=a.addStatInfoToMoreinfo,h=(null===(n=Ge.getRaw(Je))||void 0===n?void 0:n.value)||null,g=Ge.isExpired(Je),_=String(e.action_type||"")===y,[4,this.getBaseParams({ignoreSession:t.ignoreSession,ignoreSessionRn:_})]):[2,Promise.resolve()];case 1:return w=s.sent(),b=o(o({page_alias:null===(i=null===(r=window.Shopline)||void 0===r?void 0:r.uri)||void 0===i?void 0:i.alias},w),this.setDefaultEventId(e)),d&&"function"==typeof d?[4,d(b)]:[3,3];case 2:b=s.sent(),s.label=3;case 3:if(v&&"function"==typeof v&&(b=v(b)),Kn)try{S=(null===(c=ht.getRaw(pt))||void 0===c?void 0:c.value)||{},b.__session=JSON.stringify(S),k=null===(u=Ge.getRaw(dt))||void 0===u?void 0:u.value,b.__beginSessionId=this.beginSessionId,b.__bakCid=k,b.__storageType=lt,b.__lsLength=localStorage.length,b.__ssLength=sessionStorage.length,b.__cookieLength=document.cookie.length}catch(e){Oe("greyLog error",e)}return!this.skipOnSessionUpdate&&g&&h&&"function"==typeof p?(T=an.getSessionId(30,l,f),this.skipOnSessionUpdate=!0,[4,p(h,T)]):[3,5];case 4:s.sent(),this.skipOnSessionUpdate=!1,s.label=5;case 5:return t.ignoreLanding=_,[4,this.reportV2(b,t)];case 6:return[2,s.sent()];case 7:throw O=s.sent(),this.skipOnSessionUpdate=!1,Oe("[CollectError] sessionId: ".concat(an.getSessionId().sid),m(O)),O;case 8:return[2]}}))}))},t.prototype._pluginReport=function(t,n){return a(this,void 0,void 0,(function(){return s(this,(function(r){return this.validateParams(o(o({},t),{act:et}))?Object.entries(S).every((function(e){var n=e[0];return(0,e[1])(t[n])}))?[2,e.prototype._pluginReport.call(this,t,n)]:(console.error("plugin report params is invalid",t),[2,Promise.resolve()]):[2,Promise.resolve()]}))}))},t.prototype.shopperAppReport=function(e){var t,n,r=e||{},a=r.event_name,s=r.moreinfo,c=i(r,["event_name","moreinfo"]);return a&&b.includes(a)&&(null===(n=null===(t=window.shoplineAppBridge)||void 0===t?void 0:t.shopper2)||void 0===n||n.call(t,"logStatEvent",{eventName:a,eventMap:JSON.stringify({moreinfo:o(o({},s),c)})})),Promise.resolve()},t.prototype.report=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){return[2,Promise.resolve()]}))}))},t.prototype.init=function(){var e,t,n=this;if("undefined"!=typeof window&&(window.SL_Report=window.SL_Report||{},!(null===(e=window.SL_Report)||void 0===e?void 0:e.init))){window.SL_Report.init=!0;var r,o,i=function(e){var t=Array.from(e),r=t[0],o=t.slice(1),i=n[r];"function"==typeof i&&i.apply(n,o)},c="setOptions";try{(r=window.SL_Report.queue||[],o=c,null==r?void 0:r.filter((function(e){return e[0]===o}))).forEach(i),null===(t=window.SL_Report.queue)||void 0===t||t.forEach((function(e){return e[0]!==c&&i(e)})),window.SL_Report.queue=[]}catch(e){console.error(e)}!function(e){function t(){"loading"!==document.readyState&&setTimeout(e,0),document.removeEventListener("DOMContentLoaded",t),document.removeEventListener("readystatechange",t)}document.removeEventListener("DOMContentLoaded",e),document.removeEventListener("readystatechange",e),"loading"===document.readyState?(document.addEventListener("DOMContentLoaded",t),document.addEventListener("readystatechange",t)):setTimeout(e,0)}((function(){n.pageView()}));var u,d,p=qn((function(){return n.recordScrollTop()}),100);u=p,window.removeEventListener("scroll",u),window.addEventListener("scroll",u,!1),function(e){window.removeEventListener("beforeunload",e),window.addEventListener("beforeunload",e)}((function(e){var t,r,o;if("A"===(null===(r=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.activeElement)||void 0===r?void 0:r.tagName))return!1;var i={end_session:an.getRawSessionId()};return n.pageDurationTracker.reportOnLeave(i,{trigger_by:"beforeunload"}),null===(o=n.pageDurationAndLeaveTracker)||void 0===o||o.reportOnLeave(i,n.getPageLeaveParams()),n.pageLeave()})),function(e){window.removeEventListener("pagehide",e),window.addEventListener("pagehide",e)}((function(){var e,t={end_session:an.getRawSessionId()};n.pageDurationTracker.reportOnLeave(t,{trigger_by:"pagehide"}),null===(e=n.pageDurationAndLeaveTracker)||void 0===e||e.reportOnLeave(t,n.getPageLeaveParams())})),{visibleHandler:g((d={visible:function(){var e;n.pageDurationTracker.startNewPeriod(),null===(e=n.pageDurationAndLeaveTracker)||void 0===e||e.startNewPeriod()},hidden:function(){var e;n.pageDurationTracker.reportOnHide(),null===(e=n.pageDurationAndLeaveTracker)||void 0===e||e.reportOnHide()}}).visible)?d.visible:function(){},hiddenHandler:g(d.hidden)?d.hidden:function(){},visibilityChange:"",hidden:"",isSupport:function(){return void 0!==document[this.hidden]},init:function(){void 0!==document.hidden?(this.hidden="hidden",this.visibilityChange="visibilitychange"):void 0!==document.mozHidden?(this.hidden="mozHidden",this.visibilityChange="mozvisibilitychange"):void 0!==document.msHidden?(this.hidden="msHidden",this.visibilityChange="msvisibilitychange"):void 0!==document.webkitHidden&&(this.hidden="webkitHidden",this.visibilityChange="webkitvisibilitychange"),this.listen()},listen:function(){if(this.isSupport()){var e=this;document.addEventListener(this.visibilityChange,(function(){document[e.hidden]?e.hiddenHandler():e.visibleHandler()}),!0)}else window.addEventListener("focus",this.visibleHandler),window.addEventListener("blur",this.hiddenHandler)}}.init();document.addEventListener("click",(function(e){var t;if(!n.destUrlLock)for(var r=function(e){if(e.path)return e.path;if("function"==typeof e.composedPath)return e.composedPath();for(var t=[],n=e.target;n&&null!==n.parentNode;)t.push(n),n=n.parentNode;return t.push(document,window),t}(e),o=r.length-1;o>=0;o--){var i=r[o];if(i&&1===i.nodeType&&"a"===i.nodeName.toLowerCase()&&/^https?:\/\//.test(i.href)){var a={end_session:an.getRawSessionId(),page_dest_url:i.href};n.pageDurationTracker.reportOnLeave(a,{trigger_by:"click"}),null===(t=n.pageDurationAndLeaveTracker)||void 0===t||t.reportOnLeave(a,n.getPageLeaveParams()),n.pageLeave({params:{page_dest_url:i.href}}),n.pageLeaveLock=!0,setTimeout((function(){n.pageLeaveLock=!1}),100);break}}})),this.setOptions({onSessionUpdate:function(e){return a(n,void 0,void 0,(function(){var t;return s(this,(function(n){return null===(t=this.pageDurationAndLeaveTracker)||void 0===t||t.reportOnSessionChange(),[2,this.pageDurationTracker.reportOnSessionChange({session:e})]}))}))}})}},t.prototype.pageView=function(e){var t,n=void 0===e?{}:e,r=n.params,i=n.session;return a(this,void 0,void 0,(function(){return s(this,(function(e){return this.pageDurationTracker.startNewPeriod(),null===(t=this.pageDurationAndLeaveTracker)||void 0===t||t.startNewPeriod(),an.getWebVitals(),this.beginSessionId=(null==i?void 0:i.sid)||an.getRawSessionId(),[2,this.collect(o({event_name:"PageView"},r),{session:i})]}))}))},t.prototype.getPageLeaveParams=function(e){var t=this.getMaxHeightParams();return o(o(o({},t),e),an.webVitals)},t.prototype.pageLeave=function(e){var t,n=void 0===e?{}:e,r=n.params,i=n.session;return a(this,void 0,void 0,(function(){var e,n,a,c;return s(this,(function(s){return this.pageLeaveLock?[2,Promise.resolve()]:(e=this.collect(o({event_name:"PageLeave"},this.getPageLeaveParams(r)),{session:i}),n={end_session:an.getRawSessionId()},a=this.pageDurationTracker.reportOnLeave(n,{trigger_by:"pageleave"}),c=(null===(t=this.pageDurationAndLeaveTracker)||void 0===t?void 0:t.reportOnLeave(n,this.getPageLeaveParams(r)))||Promise.resolve(),this.destroy(),[2,Promise.all([e,a,c])])}))}))},t.prototype.heartbeat=function(e,t){return void 0===t&&(t=2e3),a(this,void 0,void 0,(function(){var n,r=this;return s(this,(function(i){return n=window.setInterval((function(){r.collect(o({event_name:"HeartBeat"},e)),r.heartbeatIds.push(n)}),t),[2]}))}))},t.prototype.expose=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return this.exposeInstance||(this.exposeInstance=new fn(this.collect.bind(this),{asyncLoopInterval:this.getOptions().exposeAsyncLoopInterval})),this.exposeInstance.track(e),[2]}))}))},t.prototype.onPageChange=function(e,t){return a(this,void 0,void 0,(function(){var n=this;return s(this,(function(r){return this.destUrlLock=!0,setTimeout((function(){n.destUrlLock=!1}),100),[2,Promise.all([this.pageLeave({params:e}),this.pageView({params:t})])]}))}))},t.prototype.recordScrollTop=function(){var e=document.documentElement.scrollTop;e>this.maxScrollTop&&(this.maxScrollTop=e)},t.prototype.getMaxHeightParams=function(){var e=document.documentElement||document.body,t=e?((this.maxScrollTop+e.clientHeight)/(null==e?void 0:e.scrollHeight)*100).toFixed(2):0;return{max_height:this.maxScrollTop,max_height_pc:t}},t.prototype.destroy=function(){var e;this.maxScrollTop=0,this.skipOnSessionUpdate=!1,this.beginSessionId="",this.heartbeatIds.forEach((function(e){return clearInterval(e)})),this.heartbeatIds=[],(null===(e=window.SL_Report)||void 0===e?void 0:e.exposeObserver)&&(window.SL_Report.exposeObserver.disconnect(),window.SL_Report.exposeObserver=void 0)},t}(dn));e.SDK_VERSION=sn,e.baseParams=an,e.constants=mt,e.shopTracker=Wn,e.storage=Ge,e.tracker=dn,Object.defineProperty(e,"__esModule",{value:!0})}));
